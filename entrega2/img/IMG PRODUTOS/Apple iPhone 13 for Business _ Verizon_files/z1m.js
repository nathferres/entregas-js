var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(g,m,c){g!=Array.prototype&&g!=Object.prototype&&(g[m]=c.value)};$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global&&null!=global?global:g};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var g=0;return function(m){return $jscomp.SYMBOL_PREFIX+(m||"")+g++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var g=$jscomp.global.Symbol.iterator;g||(g=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[g]&&$jscomp.defineProperty(Array.prototype,g,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(g){var m=0;return $jscomp.iteratorPrototype(function(){return m<g.length?{done:!1,value:g[m++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(g){$jscomp.initSymbolIterator();g={next:g};g[$jscomp.global.Symbol.iterator]=function(){return this};return g};$jscomp.makeIterator=function(g){$jscomp.initSymbolIterator();var m=g[Symbol.iterator];return m?m.call(g):$jscomp.arrayIterator(g)};
$jscomp.polyfill=function(g,m,c,r){if(m){c=$jscomp.global;g=g.split(".");for(r=0;r<g.length-1;r++){var f=g[r];f in c||(c[f]={});c=c[f]}g=g[g.length-1];r=c[g];m=m(r);m!=r&&null!=m&&$jscomp.defineProperty(c,g,{configurable:!0,writable:!0,value:m})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(g){function m(){this.batch_=null}function c(e){return e instanceof f?e:new f(function(c,f){c(e)})}if(g&&!$jscomp.FORCE_POLYFILL_PROMISE)return g;m.prototype.asyncExecute=function(e){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(e);return this};m.prototype.asyncExecuteBatch_=function(){var e=this;this.asyncExecuteFunction(function(){e.executeBatch_()})};var r=$jscomp.global.setTimeout;m.prototype.asyncExecuteFunction=function(e){r(e,
0)};m.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var c=0;c<e.length;++c){var f=e[c];delete e[c];try{f()}catch(w){this.asyncThrow_(w)}}}this.batch_=null};m.prototype.asyncThrow_=function(e){this.asyncExecuteFunction(function(){throw e;})};var f=function(e){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var c=this.createResolveAndReject_();try{e(c.resolve,c.reject)}catch(q){c.reject(q)}};f.prototype.createResolveAndReject_=
function(){function e(e){return function(k){f||(f=!0,e.call(c,k))}}var c=this,f=!1;return{resolve:e(this.resolveTo_),reject:e(this.reject_)}};f.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof f)this.settleSameAsPromise_(e);else{a:switch(typeof e){case "object":var c=null!=e;break a;case "function":c=!0;break a;default:c=!1}c?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}};f.prototype.resolveToNonPromiseObj_=function(e){var c=
void 0;try{c=e.then}catch(q){this.reject_(q);return}"function"==typeof c?this.settleSameAsThenable_(c,e):this.fulfill_(e)};f.prototype.reject_=function(e){this.settle_(2,e)};f.prototype.fulfill_=function(e){this.settle_(1,e)};f.prototype.settle_=function(e,c){if(0!=this.state_)throw Error("Cannot settle("+e+", "+c|"): Promise already settled in state"+this.state_);this.state_=e;this.result_=c;this.executeOnSettledCallbacks_()};f.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=
this.onSettledCallbacks_,c=0;c<e.length;++c)e[c].call(),e[c]=null;this.onSettledCallbacks_=null}};var n=new m;f.prototype.settleSameAsPromise_=function(e){var c=this.createResolveAndReject_();e.callWhenSettled_(c.resolve,c.reject)};f.prototype.settleSameAsThenable_=function(e,c){var f=this.createResolveAndReject_();try{e.call(c,f.resolve,f.reject)}catch(w){f.reject(w)}};f.prototype.then=function(e,c){function g(e,c){return"function"==typeof e?function(c){try{k(e(c))}catch(h){m(h)}}:c}var k,m,n=new f(function(e,
c){k=e;m=c});this.callWhenSettled_(g(e,k),g(c,m));return n};f.prototype.catch=function(e){return this.then(void 0,e)};f.prototype.callWhenSettled_=function(e,c){function f(){switch(g.state_){case 1:e(g.result_);break;case 2:c(g.result_);break;default:throw Error("Unexpected state: "+g.state_);}}var g=this;null==this.onSettledCallbacks_?n.asyncExecute(f):this.onSettledCallbacks_.push(function(){n.asyncExecute(f)})};f.resolve=c;f.reject=function(e){return new f(function(c,f){f(e)})};f.race=function(e){return new f(function(f,
g){for(var k=$jscomp.makeIterator(e),m=k.next();!m.done;m=k.next())c(m.value).callWhenSettled_(f,g)})};f.all=function(e){var g=$jscomp.makeIterator(e),m=g.next();return m.done?c([]):new f(function(e,f){function k(c){return function(f){n[c]=f;r--;0==r&&e(n)}}var n=[],r=0;do n.push(void 0),r++,c(m.value).callWhenSettled_(k(n.length-1),f),m=g.next();while(!m.done)})};return f},"es6","es3");$jscomp.owns=function(g,m){return Object.prototype.hasOwnProperty.call(g,m)};
$jscomp.polyfill("Object.assign",function(g){return g?g:function(g,c){for(var m=1;m<arguments.length;m++){var f=arguments[m];if(f)for(var n in f)$jscomp.owns(f,n)&&(g[n]=f[n])}return g}},"es6","es3");$jscomp.iteratorFromArray=function(g,m){$jscomp.initSymbolIterator();g instanceof String&&(g+="");var c=0,r={next:function(){if(c<g.length){var f=c++;return{value:m(f,g[f]),done:!1}}r.next=function(){return{done:!0,value:void 0}};return r.next()}};r[Symbol.iterator]=function(){return r};return r};
$jscomp.polyfill("Array.prototype.keys",function(g){return g?g:function(){return $jscomp.iteratorFromArray(this,function(g){return g})}},"es6","es3");$jscomp.polyfill("Object.is",function(g){return g?g:function(g,c){return g===c?0!==g||1/g===1/c:g!==g&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(g){return g?g:function(g,c){var m=this;m instanceof String&&(m=String(m));var f=m.length;for(c=c||0;c<f;c++)if(m[c]==g||Object.is(m[c],g))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(g,m,c){if(null==g)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(m instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return g+""};$jscomp.polyfill("String.prototype.includes",function(g){return g?g:function(g,c){return-1!==$jscomp.checkStringArgs(this,g,"includes").indexOf(g,c||0)}},"es6","es3");
$jscomp.polyfill("Number.isNaN",function(g){return g?g:function(g){return"number"===typeof g&&isNaN(g)}},"es6","es3");$jscomp.polyfill("String.prototype.startsWith",function(g){return g?g:function(g,c){var m=$jscomp.checkStringArgs(this,g,"startsWith");g+="";var f=m.length,n=g.length;c=Math.max(0,Math.min(c|0,m.length));for(var e=0;e<n&&c<f;)if(m[c++]!=g[e++])return!1;return e>=n}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(g){return g?g:function(g,c){var m=$jscomp.checkStringArgs(this,g,"endsWith");g+="";void 0===c&&(c=m.length);c=Math.max(0,Math.min(c|0,m.length));for(var f=g.length;0<f&&0<c;)if(m[--c]!=g[--f])return!1;return 0>=f}},"es6","es3");var Z1=Z1||function(){};
if(0==Z1.prototype.hasOwnProperty("initialize")){Z1.prototype=function(){var g="",m="",c=!1,r="",f=!1,n=!1,e=!1,k=null,q=[],w=!1,y="",A=30,G="minutes",L=!1,I=!1,h=null,B=null,J=[],H=!1,K="",C={},D={},z={"z1.connection.timeout":3E3,"z1.disable.sdk.on.error":!1},M={id:"id",phone:"phone",email:"email",fb:"fb"},u={_headers:[],_hostName:"",URL_PROTO:"https://",URL_HOST:"",WS_PROTO:"wss://",_getHeaderFields:function(){return this._headers},_putApiKey:function(a,b){this._headers[a]=b},_putAccessToken:function(a,
b){this._headers[a]=b},GET:function(a,b,d){var l=this;try{return new Promise(function(b,e){var c=a;if(d)for(var t in d){var g=d[t];g&&(c+="?",c=c+t+"="+g)}var f=new XMLHttpRequest;f.open("GET",l.URL_PROTO+l.URL_HOST+c,!0);f.setRequestHeader("Content-Type","text/plain");f.timeout=void 0!=z["z1.connection.timeout"]&&z["z1.connection.timeout"]?z["z1.connection.timeout"]:3E3;for(var h in l._headers)l._headers.hasOwnProperty(h)&&f.setRequestHeader(h,l._headers[h]);f.onload=function(){4==f.readyState&&
200==f.status?b(f.responseText):(x._disableSDKOnError(),e(Error(f.statusText)))};f.onerror=function(){x._disableSDKOnError();e(Error("Network Error"))};f.send()})}catch(t){console.debug(t)}},POST:function(a,b,d){b=b||{};var l=this;return new Promise(function(d,e){try{var c=b,t=new XMLHttpRequest;t.open("POST",l.URL_PROTO+l.URL_HOST+a,!0);t.setRequestHeader("Content-Type","text/plain");t.timeout=void 0!=z["z1.connection.timeout"]&&z["z1.connection.timeout"]?z["z1.connection.timeout"]:3E3;for(var f in l._headers)l._headers.hasOwnProperty(f)&&
t.setRequestHeader(f,l._headers[f]);t.onload=function(){4!=t.readyState||200!=t.status&&0!=t.status?(x._disableSDKOnError(),e(Error(t.statusText))):null==t.responseText||""==t.responseText?d(t.responseText):d(JSON.parse(t.responseText))};t.onerror=function(){x._disableSDKOnError();e(Error("Network Error"))};t.send(JSON.stringify(c))}catch(O){console.debug(O)}})}},x={_waitCount:0,_profileInfo:{},_profileId:"",_position:"",_wstoken:null,_conn:null,_glTimer:null,_connectInfo:{customerId:"",customKey:{}},
_eventList:[],_SessionStatus:{DEFAULT:0,IN_PROGRESS:1,DONE:2},_isSessionConnecting:0,_SocketStatus:{DEFAULT:0,IN_PROGRESS:1,DONE:2},_isWSConnecting:0,SystemEvent:{appStart:"appStart",appNotResponding:"appNotResponding",appExit:"appExit"},_z1_location:{streetNumber:"street_number",streetName:"route",neighborhood:"neighborhood",city:"locality",county:"administrative_area_level_2",state:"administrative_area_level_1",country:"country",postalCode:"postal_code"},ATTR_EVENT:"event",ATTR_TIME:"time",REFERRER:"_z1_referrer",
APPNAME:"app_name",APPVERSION:"app_version",BROWSER:"browser",BROWSER_VERSION:"browserversion",COUNTRY:"country",DEVICE_ID:"device_id",GEOLOCATION:"z1_loc",HEADER_APIKEY:"apikey",HEADER_ACCESSTOKEN:"accesstoken",HTML5:"html5",LANGUAGE:"language",LOCATION:"location",OS:"os",OS_VERSION:"os_version",OPTOUT_PROFILE_ID:"_z1_optout_p",WS_TOKEN:"wstoken",PAGENAME:"_z1_pagename",PAGEPATH:"_z1_pagepath",PLATFORM_OS:"platform_os",PROFILE_ID:"profileId",RESOLUTION:"resolution",TIMEZONE:"tz",TYPE:"devicetype",
Z1_ORIGIN_ID:"_z1_origin",Z1_SDK_VERSION:"z1SDKVersion",Z1_SESSION_ID:"_z1_session_id",SESSION_TRACKING_ID:"z1SessionTrackingId",Z1_CHID:"z1_chid",Z1_SCRIPT_MARKER:"z1s-tg-",ACTIVE_SESSION_FIELDS:["sessionTrackerId"],_globalTriggers:null,_dataLayer:{},_firstTimeConnect:!0,_fireLoadEvent:!1,_channelPrefix:"",_broadcastChannelName:"",__setChannelBroadcaster:function(a){a=void 0===a?"":a;var b="";void 0!=a&&a||(b="_"+(new Date).getTime());this._broadcastChannelName=this._broadcastChannelName||a+"_z1_channel"+
b;a=""+(new Date).getTime()+Math.floor(Math.random()*(new Date).getTime());_sessionStorageSetItem(this.Z1_CHID,a);null==B&&(B=new BroadcastChannel(this._broadcastChannelName))},__registerChannelListener:function(a,b){b=void 0===b?"":b;var d=null;d="";void 0!=b&&b||(d="_"+(new Date).getTime());this._broadcastChannelName=this._broadcastChannelName||b+"_z1_channel"+d;d=new BroadcastChannel(this._broadcastChannelName);d.onmessage=function(b){try{a(b.data)}catch(t){e&&(console.log("ZineOne: Could not send message to listener due to the following error"),
console.log(""+t.name+": "+t.message))}};J.push(d);e&&console.log("ZineOne: Registered a channel listener")},_broadCast:function(a){try{var b=_sessionStorageGetItem(this.Z1_CHID,!0);if(void 0==b||""==b)b=""+(new Date).getTime()+Math.floor(Math.random()*(new Date).getTime()),_sessionStorageSetItem(this.Z1_CHID,b);a[this.Z1_CHID]=b;void 0==B?e&&console.log("ZineOne: Cannot broadcast information. Failed to find broadcast channel."):B.postMessage(a)}catch(d){e&&(console.log("ZineOne: Cannot broadcast information due to following error"),
console.log(""+d.name+": "+d.message))}},__closeChannels:function(){if(void 0!=B||0!=J.length){for(B&&B.close();0<J.length;)J.pop().close();B=null;J=[]}},_addData:function(a,b){this._dataLayer[a]=b;if(this._sanityCheck()&&h&&h._globalTriggers&&0<h._globalTriggers.length)for(b=0;b<h._globalTriggers.length;b++)p._processActionMappingOnDataLayerChange("datalayerchange",h._globalTriggers[b],a)},_getData:function(a){return this._dataLayer[a]},_addProfileInfo:function(a,b){this._profileInfo[a]=b},_removeData:function(a){delete this._dataLayer[a]},
_setWSToken:function(a){this._wstoken=a},_setProfileKey:function(a){this._connectInfo.customerId=a},_getProfileKey:function(){return this._connectInfo.customerId},_sanityCheck:function(){var a=!1;if(0===this._waitCount)if(this._isSessionConnecting===this._SessionStatus.IN_PROGRESS||this._isWSConnecting===this._SocketStatus.IN_PROGRESS)a=!1;else{if(this._isSessionConnecting===this._SessionStatus.DEFAULT)return;a=this._isWSConnecting===this._SocketStatus.DEFAULT?!1:H?!0:!1}else 1<this._waitCount&&(a=
!1);return a},_connect:function(){var a=!1;if(0===this._waitCount)if(this._isSessionConnecting===this._SessionStatus.IN_PROGRESS||this._isWSConnecting===this._SocketStatus.IN_PROGRESS)a=!1;else{if(this._isSessionConnecting===this._SessionStatus.DEFAULT){this.forceConnect();return}this._isWSConnecting===this._SocketStatus.DEFAULT?(a=!1,this._wsConnect()):H?a=!0:(a=!1,this._createOriginId(h._id,h._profileId))}else 1<this._waitCount&&(a=!1);return a},forceConnect:function(a){this._waitCount++;this._sessionConnect(void 0===
a?!1:a)},_sessionConnect:function(a){a=void 0===a?!1:a;e&&console.debug("Connect check triggered");this._isSessionConnecting=this._SessionStatus.IN_PROGRESS;if(!(1<this._waitCount)){""!=_getApiKey()?u._putApiKey(this.HEADER_APIKEY,_getApiKey()):""!=_getAccessToken()&&u._putAccessToken(this.HEADER_ACCESSTOKEN,_getAccessToken());var b="";if("undefined"!==typeof Storage)try{var d=_localStorageGetItem("z1_deviceId");null==d||""==d?(b=_generateUUID(),_localStorageSetItem("z1_deviceId",b)):b=d}catch(t){}if(null===
b||""===b)b=_generateUUID();this._addProfileInfo(this.DEVICE_ID,b);d=null===_localStorageGetItem("z1_connectDirty")||"true"==_localStorageGetItem("z1_connectDirty")?!0:!1;e&&console.debug("Pre-flight checks...");L=a||this._checkNewSession({src:"connect",preFlight:!0});I=this._checkConfigStatus();this._firstTimeConnect=void 0!=_localStorageGetItem("z1_connectData_tts")?!1:this._firstTimeConnect;e&&(console.debug("Is new session? "+L),console.debug("Is this a forced connect? "+this.shouldConnect),console.debug("Was the previous connect dirty? "+
d),console.debug("--- Should the SDK load config ---"),console.debug("Has config expired? "+I),console.debug("Is this the first connect? "+this._firstTimeConnect));if(L||this.shouldConnect||d||I){a=_localStorageGetItem("z1_cust_id")&&""!=_localStorageGetItem("z1_cust_id")?_localStorageGetItem("z1_cust_id"):null!=this._connectInfo.customerId&&""!=this._connectInfo.customerId?this._connectInfo.customerId:b;d={};d.customerId=a;d.deviceId=b;d[this.OS]=this.HTML5;d.devicetype=this._getDeviceType();d.z1SDKVersion=
"2023.4.5.1";if(this._firstTimeConnect||I)b=_localStorageGetItem("z1_connectData_tts")||null,d.loadConfig=!0,void 0!=b&&(d.tts=b+""),this._firstTimeConnect=!1;null!=this._wsToken&&(d[this.WS_TOKEN]=this._wsToken);b=this._connectInfo.customKey||{};_localStorageGetItem("z1_cust_key")&&""!=_localStorageGetItem("z1_cust_key")&&this._connectInfo.customKey&&(b=Object.assign({},this._connectInfo.customKey,JSON.parse(_localStorageGetItem("z1_cust_key"))));if(b)for(a in b)d[a]=b[a];var l=this;_localStorageSetItem("z1_connectDirty",
!0);u.POST("c3/api/v1/connect",d,{}).then(function(a){a&&a.status&&"fail"===a.status?(e&&console.debug("Failed to connect, disabling SDK"),l._disableSDKOnError()):(e&&console.debug("Connect Success. Update local storage."),l._onSessionConnectSuccess(a,!0))},function(a){console.log("ZineOne Connection Failure : Failed to connect to session! ");l._disableSDKOnError()})}else e&&console.debug("No new connect calls to platform, get previous connect data from local storage."),b=_localStorageGetItem("z1_connectData")?
JSON.parse(_localStorageGetItem("z1_connectData")):null,this._onSessionConnectSuccess(b)}},_onSessionConnectSuccess:function(a,b){var d=this;this._isSessionConnecting=this._SessionStatus.DONE;var l=!1;if(void 0===b?0:b){e&&console.debug("Updating local storage...");if(b=0<(a&&a.activeSession?Object.keys(a.activeSession):[]).filter(function(a){return d.ACTIVE_SESSION_FIELDS.includes(a)}).length?!0:!1)l=!0,this._setupActiveSession(a,{hasActiveSessionInfo:b});I&&(e&&console.debug("Setting connect data timestamp to compare with TTL or 10 mins"),
_localStorageSetItem("z1_connectData_tts",Date.now()));b=null;var c=_localStorageGetItem("z1_connectData");try{b=JSON.parse(c)}catch(Q){e&&console.debug("Error in previously saved payload, overwriting it."),b=null}if(void 0!=c&&(void 0!=b||"{}"!=b))if(a&&a.config&&0!=Object.keys(a.config).length){e&&console.debug("Found new config in response from platform");e&&console.debug("Combining new connectData.config with existing z1_connectData.config in local storage");c=b.config?JSON.parse(JSON.stringify(b.config)):
{};b=JSON.parse(JSON.stringify(a.config));a.config=c;c=Object.keys(b);for(var f=!1===a.actionMappingChanged?!1:!0,g=!1===a.sdkPropsChanged?!1:!0,h=0;h<c.length;h++)b[c[h]]&&(a.config[c[h]]="actionMapping"==c[h]?f?b[c[h]]:a.config[c[h]]:"sdkprops"==c[h]?g?b[c[h]]:a.config[c[h]]:b[c[h]])}else e&&console.debug("No new config in response from platform"),e&&console.debug("Using existing config in local storage (if any)"),c=b.config?JSON.parse(JSON.stringify(b.config)):{},a.config=c;_localStorageSetItem("z1_connectData",
JSON.stringify(a));e&&console.debug("Finished updating local storage")}e&&console.debug("Set up SDK Config and Props");this._setupSDKConfig(a);this._setupSDKProps(a);1<this._waitCount?(e&&console.debug("There is another connect call in flight - return to beginning"),this._waitCount=0,_localStorageSetItem("z1_connectDirty",!0),localStorage.removeItem("z1_connectUserId"),this._sessionConnect()):(e&&console.debug("Finished all connect calls!"),this._waitCount=0,_localStorageSetItem("z1_connectDirty",
!1),_localStorageSetItem("z1_connectUserId",a.id),this._broadCast({topic:"Z1_INIT",message:{data:JSON.parse(JSON.stringify(a))},status:"success"}),e&&console.debug("Setting profile to session"),null!=a&&(null!=a.profileId&&(this._profileId=a.profileId?a.profileId:"",this._profileId===this.OPTOUT_PROFILE_ID&&(e&&console.debug("ZineOne: This profile has opted-out, turning off the SDK."),ZineOne.turnOffApi(!0))),null!=a.id&&(this._id=a.id?a.id:""),e&&console.debug("Post flight check..."),e&&console.debug("Is this a new session now that there is a new profile?"),
a=!1,(a=this._checkNewSession({src:"connect",platformSendSTID:l}))&&this._fireAppStart(),k&&(l={},l.deviceId=_localStorageGetItem("z1_deviceId")?_localStorageGetItem("z1_deviceId"):null,l.profileId=this._profileId?this._profileId:null,k(l)),this._isWSConnecting===this._SocketStatus.DEFAULT&&this._wsConnect(),this._isWSConnecting!==this._SocketStatus.IN_PROGRESS&&(H?0!=this._eventList.length&&(e&&console.debug("Flushing events that were waiting for a websocket connect..."),this._flush()):this._createOriginId(this._id,
this._profileId,!1))),e&&console.debug("Post connect: SDK props have changed, checking location status"),_setLocation(),_checkStorageStatus())},_setupActiveSession:function(a,b){b.hasActiveSessionInfo&&(b=_localStorageGetItem("z1_sessionData",!0)?JSON.parse(_localStorageGetItem("z1_sessionData",!0)):{},b.z1_last_profile_id=a.activeSession.sessionTrackerId||b.z1_last_profile_id,_localStorageSetItem("z1_sessionData",JSON.stringify(b)),this._eventList=this._eventList.filter(function(a){return a[this.ATTR_EVENT]!=
this.SystemEvent.appStart},this))},_setupSDKConfig:function(a){a&&a.config&&(null!=a.config.actionMapping&&(a.config.actionMapping&&0<a.config.actionMapping.length&&(1<a.config.actionMapping.length?a.config.actionMapping.slice(1):[]).sort(function(a,d){return a.actionType.toLowerCase()===p.ACTION_MAPPING_TYPE_SCRIPT?-1:1}),this._globalTriggers=a.config.actionMapping?a.config.actionMapping:null),null!=a.config.props&&(c=a.config.props.disableUrlParamCapture?a.config.props.disableUrlParamCapture:!1,
w=a.config.props.locationEnabled?a.config.props.locationEnabled:!1,y=a.config.props.geoCodeLocationKey?a.config.props.geoCodeLocationKey:"",A=a.config.props.geoCodeReqRateValue?a.config.props.geoCodeReqRateValue:30,G=a.config.props.geoCodeReqRateUnit?a.config.props.geoCodeReqRateUnit:"minutes"))},_setupSDKProps:function(a){a&&a.config&&a.config.sdkprops&&(z["z1.connection.timeout"]=void 0!=a.config.sdkprops["z1.connection.timeout"]?a.config.sdkprops["z1.connection.timeout"]:z["z1.connection.timeout"],
z["z1.disable.sdk.on.error"]=void 0!=a.config.sdkprops["z1.disable.sdk.on.error"]?a.config.sdkprops["z1.disable.sdk.on.error"]:z["z1.disable.sdk.on.error"])},_getULocation:function(){var a=_isLocationEnabled();0==a&&null!=this._glTimer&&(e&&console.debug("Location is no longer enabled. Clearing the existing interval timer."),clearInterval(this._glTimer),this._glTimer=null);e&&console.debug("Is Location Enabled "+a);e&&console.debug("Is navigator geolocation available "+navigator.geolocation);a&&navigator.geolocation&&
(e&&console.debug("Query geolocation"),navigator.geolocation.getCurrentPosition(this._successPosition,this._errorPosition,{enableHighAccuracy:!0,timeout:5E3,maximumAge:0}))},_setGLInterval:function(){var a=void 0!=A?parseInt(A):30,b=G,d=_localStorageGetItem("z1_connectData")?JSON.parse(_localStorageGetItem("z1_connectData")):null;d&&d.config&&d.config.props&&(a=d.config.props.geoCodeReqRateValue?parseInt(d.config.props.geoCodeReqRateValue):null,b=d.config.props.geoCodeReqRateUnit?d.config.props.geoCodeReqRateUnit:
null);if(null==a||null==b)a=30,b="minutes";a=6E4*("hours"===b.toLowerCase()?60*a:a);e&&console.debug("Setting timeout for: "+a+" milliseconds");this._glTimer=window.setInterval(function(){this._getULocation()}.bind(this),a)},_disableSDKOnError:function(){void 0!=z["z1.disable.sdk.on.error"]&&z["z1.disable.sdk.on.error"]&&ZineOne.turnOffApi(!0)},_wsConnect:function(){if(this._profileId===this.OPTOUT_PROFILE_ID)e&&console.log("ZineOne: This profile has opted-out, rejecting the request for connectwebsocket.");
else{this._isWSConnecting=this._SocketStatus.IN_PROGRESS;var a="c3/api/v1/connectwebsocket/"+_localStorageGetItem("z1_deviceId");""!=_getApiKey()?u._putApiKey(this.HEADER_APIKEY,_getApiKey()):""!=_getAccessToken()&&u._putAccessToken(this.HEADER_ACCESSTOKEN,_getAccessToken());var b=this;u.GET(a,{},{}).then(function(a){(a=JSON.parse(a))&&a.status&&"fail"===a.status||b._onWSConnectSuccessful(a)},function(a){console.log("ZineOne Connection Failure : Failed to connect to websocket! ")})}},_onWSConnectSuccessful:function(a){a=
a.token;null!=a&&(this._setWSToken(a),this._openSocket())},_openSocket:function(){try{var a=u.WS_PROTO+u.URL_HOST+"websock/"+this._wstoken;a=""!=_getApiKey()?a+("?apikey="+g):a+("?accesstoken="+_getAccessToken());this._conn=new WebSocket(a);var b=this;this._conn.onopen=function(){b._isWSConnecting=b._SocketStatus.DONE;H?b._reFlush():b._createOriginId(b._id,b._profileId)};this._conn.onmessage=function(a){if(a){for(var d=0;d<q.length;d++){var c=q[d];if(null!=c._listeners&&0<c._listeners.length)for(var e=
0;e<c._listeners.length;e++){var f=JSON.parse(a.data),g=f.info&&f.info.actionId?f.info.actionId:null,h=f.info&&f.info.__link?f.info.__link:null,k=f.info&&f.info._z1_origin?f.info._z1_origin:null;if(null===k||k!=K)return;if("kb"===f.type||"fullscreen"===f.type){k=JSON.parse(f.message);var m=k.items;m&&(b._massageData(m),c._listeners[e].onMessage({type:f.type,actionId:g,message:k.items,link:h}))}else c._listeners[e].onMessage(f)}}b._broadCast({topic:"Z1_AXN",message:{data:Object.assign({},JSON.parse(a.data))},
status:"success"})}};this._conn.onclose=function(){b._conn=null;b._isWSConnecting=b._SocketStatus.DEFAULT;for(var a=0;a<q.length;a++){var l=q[a];if(null!=l._listeners&&"function"==typeof l._listeners.onclose)l._listeners.onclose()}};this._conn.onerror=function(){console.log("ZineOne API Failure: Websocket closed on error");b._conn=null;b._isWSConnecting=b._SocketStatus.DEFAULT;for(var a=0;a<q.length;a++){var l=q[a];if(null!=l._listeners&&"function"==typeof l._listeners.onclose)l._listeners.onclose()}}}catch(d){}},
_massageData:function(a){if(a)for(var b=0;b<a.length;b++)if(!a[b].contentUrl){var d=a[b].id;d=u.URL_PROTO+u.URL_HOST+"c3/api/v1/kbdoc/"+d;""!=_getApiKey()?d+="?apikey="+_getApiKey():""!=_getAccessToken()&&(d+="?accesstoken="+_getAccessToken());a[b].contentUrl=d}return a},_createOriginId:function(a,b,d){d=void 0===d?!0:d;try{(_localStorageGetItem("z1_cust_id")||h._connectInfo.customerId||"")===a?this._onCreate(b,d):_localStorageGetItem("z1_deviceId")&&_localStorageGetItem("z1_deviceId")===a&&this._onCreate(b,
d)}catch(l){e&&(console.log("ZineOne: Unable to create Origin Id due to following error"),console.log(""+l.name+": "+l.message))}},_onCreate:function(a,b){b=void 0===b?!0:b;K=_generateUUID();var d=this;u.POST("c3/api/v1/originId?originId="+K+"&profileId="+a,{},{}).then(function(a){d.onOriginIdSaved(a,b)},function(a){console.log("ZineOne API Failure : Failed to save origin ID!")})},onOriginIdSaved:function(a,b){H=!0;(void 0===b||b)&&this._fireBodyOnLoadEvents();this._reFlush()},_reFlush:function(){0!=
h._eventList.length&&(e&&console.debug("Attempting to re-flush after stability checks"),this._flush())},_checkConfigStatus:function(){if("undefined"==typeof Storage)return!0;var a=!1;try{var b=_localStorageGetItem("z1_connectData_tts"),d=_localStorageGetItem("z1_connectData")?JSON.parse(_localStorageGetItem("z1_connectData")):null,l=10;d&&d.config&&0!=Object.keys(d.config).length&&(l=void 0==d.config.z1_ttl||Number.isNaN(Number(d.config.z1_ttl))?l:Number(d.config.z1_ttl));var c=Date.now();void 0==
b?a=!0:Math.abs(Math.round((c-b)/1E3/60))>l&&(a=!0)}catch(E){}return a},_checkSessionBoundaryByTime:function(a){var b=!1;try{var d=_localStorageGetItem("z1_connectData")?JSON.parse(_localStorageGetItem("z1_connectData")):null,l=d&&void 0!=d.sessionTime?Number(d.sessionTime):30;l*=6E4;var c=Date.now(),f=void 0!=a&&a.z1_last_activity_ts?a.z1_last_activity_ts:c,g=_localStorageGetItem("z1_sessionStart_ts",!0),h=void 0!=a&&a.z1_session_id?a.z1_session_id:null;b=void 0==g||void 0==h?!0:c-f>l;e&&console.debug("Is session start time null? "+
(void 0==g).toString());e&&console.debug("Is session ID null? "+(void 0==h).toString());e&&console.debug("Did it cross the session inactivity time? "+(c-f>l));e&&console.log("Should reset session? "+b)}catch(Q){}return b},_updateSessionBoundaryWithProfileCheck:function(a){a=void 0===a?{}:a;var b=!1,d=a.sessionData,l=a.preFlight||!1;a=a.platformSendSTID||!1;try{if(0==l){var c=l=!1,f=h._profileId,g=_localStorageGetItem("z1_deviceId"),k=_localStorageGetItem("z1_cust_id",!0),m=_localStorageGetItem("z1_connectUserId",
!0);k=void 0!=k&&""!=k?k:m;k=void 0!=k&&""!=k?k:null!=h._connectInfo.customerId&&""!=h._connectInfo.customerId?h._connectInfo.customerId:g;var n=void 0!=d&&d.z1_last_profile_id?d.z1_last_profile_id:null;void 0!=n&&""!=n||void 0==d||void 0==f||""==f||(d.z1_last_profile_id=f,_localStorageSetItem("z1_sessionData",JSON.stringify(d)));var p=void 0!=d&&d.z1_last_cust_id?d.z1_last_cust_id:null;m=void 0==p?!0:!1;l=f!=n?!0:!1;p&&(c=k!=p&&p!=g?!0:!1);k!=p&&(d.z1_last_cust_id=k,_localStorageSetItem("z1_sessionData",
JSON.stringify(d)));null!=f&&""!=f&&c&&(b=b||l);e&&console.debug("Has customer ID changed from one known user to another known user? "+c);e&&console.debug("Has profile changed? "+l);e&&console.log("Should still reset session after considering profileID? "+b);if(b||m){e&&console.debug("First Connect or Session boundary crossed due to changing from one known profile to another!");e&&console.debug("Updating session data...");e&&console.log("Setting Session Tracking ID");var q=h._profileId;a||(d.z1_last_profile_id=
q);_localStorageSetItem("z1_sessionData",JSON.stringify(d))}}}catch(T){}return[b,d]},_checkNewSession:function(a){a=void 0===a?{}:a;if("undefined"==typeof Storage)return!0;var b=!1,d=a.src||"",l=a.preFlight||!1;a=a.platformSendSTID||!1;try{var c=_localStorageGetItem("z1_sessionData",!0)?JSON.parse(_localStorageGetItem("z1_sessionData",!0)):{},f=this._checkSessionBoundaryByTime(c);if("connect"==d){var g=this._updateSessionBoundaryWithProfileCheck({sessionData:c,preFlight:l,platformSendSTID:a});f=f||
g[0];c=void 0!=g[1]&&0!=Object.keys(g[1]).length?g[1]:c}if(f){1==l&&e&&console.debug("[Note] Pre-flight checks do not affect session data or compare profile ID's");if(0==l){e&&console.debug("Session checks passed, creating new session!");e&&console.log("--- NEW SESSION ---");e&&console.debug("Updating session data...");var h=_generateUUID();c.z1_session_id=h;var k=(new Date).getTime();e&&console.log("Setting Session ID and Session Start Time");_localStorageSetItem("z1_sessionStart_ts",k);_localStorageSetItem("z1_sessionData",
JSON.stringify(c));this._broadCast({topic:"Z1_START_SESSION",message:{},status:"success"});e&&console.debug("Done setting session data.")}b=!0}}catch(O){}return b},_fireAppStart:function(){var a=this._eventList.filter(function(a){return a[this.ATTR_EVENT]==this.SystemEvent.appStart},this);Array.isArray(a)&&0==a.length&&(e&&console.debug("Adding app start to event list"),h._pushEvent(this.SystemEvent.appStart,null,!0))},_shouldConnectWithKey:function(a,b){if(a&&""!==a&&b&&""!==b&&"undefined"!=typeof Storage){this.shouldConnect=
!1;try{var d=_localStorageGetItem(a)?_localStorageGetItem(a):null;if(null==d)_localStorageSetItem(a,b),this.shouldConnect=!0;else if("z1_cust_key"===a){var l=JSON.parse(d),c=JSON.parse(b);for(item in c)if(l[item]){if(l[item]!=c[item]){_localStorageSetItem(a,b);this.shouldConnect=!0;break}}else{_localStorageSetItem(a,b);this.shouldConnect=!0;break}}else d!=b&&(_localStorageSetItem(a,b),this.shouldConnect=!0)}catch(E){}return this.shouldConnect}},_fireBodyOnLoadEvents:function(){if(h&&h._globalTriggers&&
0<h._globalTriggers.length){this._cleanUpSDKTags();for(var a=0;a<h._globalTriggers.length;a++){var b=h._globalTriggers[a];b.actionType.toLowerCase()===p.ACTION_MAPPING_TYPE_SCRIPT&&this._createScriptForExecution(b);p._processActionMappingOnLoad("load",b)}}},_cleanUpSDKTags:function(){var a=document.querySelectorAll("[data-id^="+this.Z1_SCRIPT_MARKER+"]")||[];0<a.length&&a.forEach(function(a){return"function"==typeof a.remove?a.remove():void 0})},_createScriptForExecution:function(a){var b=a.tagName+
"_"+Math.floor(1E3*Math.random()+1);b=b.replace(/ /g,"");a.methodName=b;var d=document.createElement("script");d.type="text/javascript";d.dataset.id=""+this.Z1_SCRIPT_MARKER+b;d.text="function "+b+"(){ try{\n"+(void 0!=a.script?a.script:"")+"\n}catch(e){console.log('ZineOne : Unable to execute script');} }";document.head.appendChild(d);this._broadCast({topic:"Z1_TGINIT",message:{data:{tagName:a.tagName,methodName:b,time:(new Date).getTime()}},status:"success"})},_pushEvent:function(a,b,d){if(!f){var l=
{},c=!1;0==(void 0===d?!1:d)&&(e&&console.debug("Confirm that the session is still valid before pushing an event"),c=this._checkNewSession());this._updateActivityTime();for(var g in b)b.hasOwnProperty(g)&&(l[g]=b[g]);l[this.ATTR_TIME]=Date.now();l[this.ATTR_EVENT]=a;l[this.REFERRER]=document.referrer;this._populateContext();this._eventList.push(l);e&&console.debug("Event added to event list");c?(this.forceConnect(c),this._fireAppStart()):this._flush()}},_updateActivityTime:function(){e&&console.debug("Updating activity time");
var a=_localStorageGetItem("z1_sessionData",!0)?JSON.parse(_localStorageGetItem("z1_sessionData",!0)):{};a.z1_last_activity_ts=Date.now();_localStorageSetItem("z1_sessionData",JSON.stringify(a))},_populateContext:function(){var a=this._profileInfo;a[this.Z1_ORIGIN_ID]=K;this._getDeviceCtx(a)},_getDeviceCtx:function(a){a[this.OS]="html5";a[this.OS_VERSION]=Z1.window.browserInfo.osVersion;a[this.PLATFORM_OS]=Z1.window.browserInfo.os;var b=navigator.language?navigator.language:navigator.browserLanguage?
navigator.browserLanguage:navigator.userLanguage;b&&(b=b.split("-"),a[this.LANGUAGE]=b[0]);b=(new Date).toString();b=-1<b.indexOf("(")?b.match(/\([^\)]+\)/)[0].match(/[A-Z]/g).join(""):b.match(/[A-Z]{3,4}/)[0];Intl&&Intl.DateTimeFormat()&&Intl.DateTimeFormat().resolvedOptions()&&(b=Intl.DateTimeFormat().resolvedOptions().timeZone||b);a[this.TIMEZONE]=b;a[this.TYPE]=this._getDeviceType();a[this.BROWSER]=Z1.window.browserInfo.browser;a[this.BROWSER_VERSION]=Z1.window.browserInfo.browser+":"+Z1.window.browserInfo.browserVersion;
a[this.RESOLUTION]=Z1.window.browserInfo.screen;a[this.PAGENAME]=Z1.window.browserInfo.pageName;a[this.PAGEPATH]=Z1.window.browserInfo.pagePath;return a},_getDeviceType:function(){if(this._isMobile(navigator.userAgent.toLowerCase())){var a="phone";this._isTablet(navigator.userAgent.toLowerCase())&&(a="tablet")}else a=this._isTablet(navigator.userAgent.toLowerCase())?"tablet":"desktop";return a},_isMobile:function(a){return/mobile|ip(hone|od|ad)|android|blackBerry|iemobile|kindle|netfront|silk-accelerated|(hpw|web)os|fennec|minimo|opera m(obi|ini)|blazer|dolfin|dolphin|skyfire|zune/.test(a)},
_isTablet:function(a){return/ipad/.test(a)||/macintosh/.test(a)&&"ontouchend"in document||/android/.test(a)&&/(chrome\/[.0-9]* (?!mobile))/.test(a)||-1<a.indexOf("mozilla/5.0")&&-1<a.indexOf("android ")&&-1<a.indexOf("applewebkit")&&/(?!mobile)/.test(a)&&!(-1<a.indexOf("chrome"))},_successPosition:function(a){e&&console.debug("Success: Location");x._position=a;y&&""!=y?(e&&console.debug("Success: Getting specific location"),x._getActualLocation()):(e&&console.debug("Success: Getting approximate location"),
a=x._getLocationPayload(a),void 0!=a&&x._pushLocationEvent(a))},_getLocationPayload:function(a){var b=h._profileId;if(null==b||""==b){var d=_localStorageGetItem("z1_connectData")?JSON.parse(_localStorageGetItem("z1_connectData")):null;d&&(b=d.profileId?d.profileId:null)}if(null!=b&&""!=b&&(d=a&&a.coords?a.coords:{},a="",d.latitude&&(a+="latitude="+d.latitude+"|"),d.longitude&&(a+="longitude="+d.longitude+"|"),d.altitude&&(a+="altitude="+d.altitude+"|"),d.accuracy&&(a+="accuracy="+d.accuracy+"|"),
""!=a))return d={},d[this.GEOLOCATION]=a+"type=fine|",d[this.PROFILE_ID]=b,d},_pushLocationEvent:function(a){if(!f){e&&console.debug("Checking for a new session before pushing location information.");this._checkNewSession()&&this._fireAppStart();this._updateActivityTime();var b=_localStorageGetItem("z1_sessionData",!0)?JSON.parse(_localStorageGetItem("z1_sessionData",!0)):{};void 0!=b.z1_session_id&&(a[this.Z1_SESSION_ID]=b&&b.z1_session_id?b.z1_session_id:null);u.POST("c3/api/v1/location",a,{}).then(function(a){e&&
console.log("ZineOne Location Send Success")},function(a){console.log("ZineOne API Failure: Failed to send location information!")})}},_getActualLocation:function(){var a="https://maps.googleapis.com/maps/api/geocode/json?latlng="+this._position.coords.latitude+"%2C"+this._position.coords.longitude+"&language=en&key="+y,b=this,d=new XMLHttpRequest;d.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var a=this.response?JSON.parse(this.response):null,d="";if(a&&a.results&&a.results[0]&&
a.results[0].address_components)for(key in a=a.results[0],b._z1_location)for(var c=b._z1_location[key],f=0;f<a.address_components.length;f++){var g=a.address_components[f].types&&a.address_components[f].types[0]?a.address_components[f].types[0]:"";c.toLowerCase()===g.toLowerCase()&&(d+=key+"="+a.address_components[f].long_name+"|")}b._position.coords.latitude&&""!=b._position.coords.latitude&&(d+="latitude="+b._position.coords.latitude+"|");b._position.coords.longitude&&""!=b._position.coords.longitude&&
(d+="longitude="+b._position.coords.longitude+"|");b._position.coords.accuracy&&""!=b._position.coords.accuracy&&(d+="accuracy="+b._position.coords.accuracy+"|");b._position.coords.altitude&&""!=b._position.coords.altitude&&(d+="altitude="+b._position.coords.altitude+"|");e&&console.log(d);a=b._z1Session._profileId;(null==a||""==a)&&(c=b._localStorageGetItem("z1_connectData")?JSON.parse(b._localStorageGetItem("z1_connectData")):null)&&(a=c.profileId?c.profileId:null);c={};c[b.GEOLOCATION]=d;(c[b.PROFILE_ID]=
a)&&""!=a&&b._Session._pushLocationEvent(c)}};d.open("GET",a,!0);d.send()},_errorPosition:function(a){e&&(console.debug("Failure: Getting approximate location"),console.warn("ERROR("+a.code+"): "+a.message));a=x._getLocationPayload(x._position);void 0!=a&&x._pushLocationEvent(a)},_flush:function(){e&&console.debug("Starting to flush");if(0!==this._eventList.length){e&&console.debug("Confirming stable connection...");var a=this._connect(),b={};decodeURIComponent(window.location.search.substring(1)).replace(/([^?=&]+)(=([^&]*))?/g,
function(a,d,c,l){b[d]=l});if(a){e&&console.debug("Connection is stable");a=_localStorageGetItem("z1_sessionData",!0)?JSON.parse(_localStorageGetItem("z1_sessionData",!0)):{};e&&console.debug("Adding session ID, session tracking ID and other profile info to each event and flushing...");var d=null;a&&0<Object.keys(a).length&&(d=a.z1_last_profile_id?a.z1_last_profile_id:d);for(var l=0;l<this._eventList.length;l++){var f=this._eventList[l];this._profileInfo[this.Z1_SESSION_ID]=void 0!=a&&a.z1_session_id?
a.z1_session_id:null;this._profileInfo[this.SESSION_TRACKING_ID]=d;f.z1_profile=this._profileInfo;f.z1_profile[this.Z1_ORIGIN_ID]=K;f[this.PROFILE_ID]=h._profileId;f[this.Z1_SDK_VERSION]="2023.4.5.1";null!=this._wstoken&&(f[this.WS_TOKEN]=this._wstoken);if(!c){f._z1_qsp={};for(var g in b)b.hasOwnProperty(g)&&(f._z1_qsp[g]=b[g])}this._broadCast({topic:"Z1_EVT",message:{data:{name:f[this.ATTR_EVENT],time:JSON.parse(JSON.stringify(f[this.ATTR_TIME])),body:JSON.parse(JSON.stringify(f))}},status:"success"})}g=
this._eventList;this._eventList=[];var k=this;u.POST("c3/api/v1/event",g,{}).then(function(a){k._onFlushSuccess(a)},function(a){console.log("ZineOne API Failure: Failed to flush an event!")})}}},_onFlushSuccess:function(a){e&&console.debug("Events flushed with current session ID and profile ID");p&&p._openLink()}},R={_listeners:[],instance:function(){q.push(this);return this},connect:function(a){this._listeners.push(a)}},p={_actionId:null,_configMap:null,_contentDiv:null,_contentData:null,_contentLink:null,
_close:!0,_bannerTimer:null,_isBannerModal:!1,_lifecycleCB:[],_list:null,_link:"",_lu:null,_msgData:null,_showListView:!1,_globalProperties:"",_type:null,_track:"",_widgetCB:[],Z1_PROTOCOL:"z1://",Z1_CLOSE:"z1://close",Z1_CLOSE_ATTR:"data-zineone-close",Z1_CTA_ATTR:"data-zineone-cta",Z1_PUSH_EVT:"z1://pushEvent",Z1_LINK_ATTR:"data-zineone-link",Z1_LINK_VAL:"",Z1_PROP_ATTR:"data-zineone-properties",Z1_META_TAG:"data-zineone-meta",Z1_DOM_EVENTS:"click,touchstart",ACTION_MAPPING_TYPE_PUSH:"z1push",ACTION_MAPPING_TYPE_SCRIPT:"z1script",
ACTION_MAPPING_PARAM_CONSTANT:"constant",ACTION_MAPPING_PARAM_COMPUTED:"computed",ACTION_MAPPING_PARAM_DATALAYER:"data",ACTION_MAPPING_PARAM_EVENT:"event",_printZ1WidgetVersion:function(){e&&console.log("ZineOne Widgets sdk version: 2023.4.5.1")},_handleBodyClickEvents:function(a){this._onDocumentEvents(a)},_onDocumentEvents:function(a){if(this._widgetCB)for(var b in this._widgetCB)if(b===this._type)return;a&&(b=a.target||a.srcElement,this._resetMetaTagValues(),this._processMetaTag(b),b&&b.getAttribute("href")&&
b.getAttribute("href")===this.Z1_CLOSE?(this._onAction(a,b.getAttribute("href")),this._sendActionResponse(null,"dismissed")):b&&b.getAttribute(this.Z1_CLOSE_ATTR)&&b.getAttribute(this.Z1_CLOSE_ATTR)===this.Z1_CLOSE?(this._onAction(a,b.getAttribute(this.Z1_CLOSE_ATTR)),this._sendActionResponse(null,"dismissed")):this._link&&""!=this._link?(this.Z1_LINK_VAL=this._link,this._track&&""!=this._track&&-1!=this._track.search(this.Z1_PUSH_EVT)&&this._onAction(a,this._track)):this._track&&""!=this._track&&
-1!=this._track.search(this.Z1_PUSH_EVT)?this._onAction(a,this._track):b&&b.getAttribute("href")&&-1!=b.getAttribute("href").search(this.Z1_PUSH_EVT)?this._onAction(a,b.getAttribute("href")):"banner"===this._type&&(this._checkBannerModality(),this._isBannerModal||("none"!=(this._contentDiv&&this._contentDiv.style?this._contentDiv.style.display:"none")&&this._sendActionResponse(null,"dismissed"),clearTimeout(this._bannerTimer),this._removeBannerAnimationCss())))},_resetMetaTagValues:function(){this._link=
this._track="";this._close=!0},_processMetaTag:function(a){var b;if(a&&a.getAttribute(this.Z1_META_TAG)&&(a=a.getAttribute(this.Z1_META_TAG),""!=a&&(a=a.split(";"))&&0<a.length))for(var d=0;d<a.length;d++)if((b=a[d].split(/:(.+)?/))&&0<b.length){var c=b[0];c&&""!=c&&("track"===c.toLowerCase()&&(this._track=b[1]),"link"===c.toLowerCase()&&(this._link=b[1]),"close"===c.toLowerCase()&&(this._close="false"===b[1]?!1:!0))}},_setProperty:function(a){this._globalProperties=a},_getProperty:function(){return this._globalProperties},
_createBanner:function(){var a=this,b="",d="";this._actionId=this._msgData.info&&this._msgData.info.actionId?this._msgData.info.actionId:null;this._deepLink=this._msgData.info&&this._msgData.info.__link?this._msgData.info.__link:null;var c=this._msgData.message.search(this.Z1_PROP_ATTR);d=this._getBannerPosition(c);b=this._getBannerCoords(d);this._contentData=b=this._msgData.message.replace(/{z1_position_val}/g,b);this._contentLink=this._msgData&&this._msgData.info&&this._msgData.info.__link?this._msgData.info.__link:
null;this._beforeRender();this._contentDiv.style.display="block";var e=document.createElement("div");e.setAttribute("class","z1_b_topDiv");e.innerHTML=b;this._contentDiv.appendChild(e);b=this._getContainerClass()||"z1_b_container";this._contentDiv.setAttribute("class",b);this._animateBanner(d);this.Z1_DOM_EVENTS.split(",").map(function(b){e.addEventListener(b,a._takeBannerAction.bind(a),{passive:!1,capture:!1})});this._sendActionResponse(null,"reached");this._checkBannerModality(c);this._afterRender();
if(!this._isBannerModal){d=1E4;this._configMap&&this._configMap["z1.banner.secondsToShow"]&&""!=this._configMap["z1.banner.secondsToShow"]&&(d=1E3*parseInt(this._configMap["z1.banner.secondsToShow"]));var f=this;this._bannerTimer=setTimeout(function(){f._contentDiv&&"banner"===f._type&&(f._checkBannerModality(),f._isBannerModal||f._removeBannerAnimationCss())},d)}},_getBannerPosition:function(a){var b=/(position:top)|(position:bottom)|(position:center)/;b=this._msgData.message.match(b)?this._msgData.message.match(b)[0]:
"";var d="";-1!=a&&""!=b&&(d=b.substring(b.indexOf(":")+1));return""!=d?d:this._msgData.info&&this._msgData.info.position?this._msgData.info.position:"top"},_getBannerCoords:function(a){var b="";a&&(b="desktop"===h._getDeviceType()?"top"===a.toLowerCase()?"top: -80px;":"bottom"===a.toLowerCase()?"bottom: -80px; right:10px;":"center"===a.toLowerCase()?"top: 40%; right: -100%;":"top: -80px;":"top"===a.toLowerCase()?"top: -80px;":"bottom"===a.toLowerCase()?"bottom: -80px;":"center"===a.toLowerCase()?
"top: 40%; left: 100%; right: -100%;":"top: -80px;");return b},_animateBanner:function(a){var b="";this._configMap&&this._configMap["z1.banner.offset"]&&""!=this._configMap["z1.banner.offset"]&&(b=this._configMap["z1.banner.offset"]+"px");a&&("top"===a.toLowerCase()?(window.getComputedStyle(this._contentDiv).top,this._contentDiv.style.top="0px","desktop"===h._getDeviceType()?(this._contentDiv.style.top=b?b:"30px",this._contentDiv.style.right="60px"):this._contentDiv.style.top=b?b:"0px"):"bottom"===
a.toLowerCase()?(window.getComputedStyle(this._contentDiv).bottom,"desktop"===h._getDeviceType()?(this._contentDiv.style.bottom=b?b:"30px",this._contentDiv.style.right="60px"):this._contentDiv.style.bottom=b?b:"0px"):"center"===a.toLowerCase()?(window.getComputedStyle(this._contentDiv).left,window.getComputedStyle(this._contentDiv).right,"desktop"===h._getDeviceType()?this._contentDiv.style.right="60px":(this._contentDiv.style.left="0px",this._contentDiv.style.right="0px")):(window.getComputedStyle(this._contentDiv).top,
this._contentDiv.style.top="0px"))},_checkBannerModality:function(){this._getProperty()&&""!=this._getProperty()?this._setBannerModalProp(this._getProperty(),"modal"):this._isBannerModal=this._isModal()},_setBannerModalProp:function(a,b){if((propItems=a.split(","))&&0<propItems.length)for(var d=0;d<propItems.length;d++)if(a=propItems[d].trim().split(":"),a[0].trim().toLowerCase()===b.toLowerCase()){this._isBannerModal="true"===a[1].trim()?!0:!1;break}else this._isBannerModal=this._isModal()},_isModal:function(){var a=
this._getDataZ1Properties();return a?"true"===a.modal:!1},_getContainerClass:function(){var a=this._getDataZ1Properties();return a?a["container-class"]:null},_getDataZ1Properties:function(){var a=this._msgData.message;a.constructor===Array&&(a=a[0].content);if(-1!=a.search(this.Z1_PROP_ATTR)){if(a=document.querySelector("[data-zineone-properties]")){a=a.getAttribute(this.Z1_PROP_ATTR);if(!a)return null;a=a.split(";");for(var b={},d=0;d<a.length;d++)if(0!=a[d].length){var c=a[d].split(":");b[c[0]]=
c[1]}return b}}else return null},_createAlert:function(){this._contentDiv.style.display="block";this._actionId=this._msgData.info&&this._msgData.info.actionId?this._msgData.info.actionId:null;var a=JSON.parse(this._msgData.message),b=document.createElement("div");b.innerHTML=a.alertMsg;b.classList.add("z1_alert_container");this._contentData=a;this._contentLink=this._msgData&&this._msgData.info&&this._msgData.info.__link?this._msgData.info.__link:null;this._beforeRender();this._openModal(a.alertTitle,
b,!1,this._msgData.type);this._sendActionResponse(null,"reached");this._afterRender()},_createFullScreen:function(){var a=this;this._contentDiv.style.display="block";this._actionId=this._msgData.actionId;this._deepLink=this._msgData.link;this._list=this._msgData.message;var b="";this._list&&0<this._list.length&&(b=this._list[0]);this._contentData=b.content;this._contentLink=this._deepLink;this._beforeRender();this._createFSDiv(b);document.addEventListener?this.Z1_DOM_EVENTS.split(",").map(function(b){document.getElementById("fs_modal_close").addEventListener(b,
a.onCloseFS,!1)}):document.getElementById("fs_modal_close").attachEvent("onclick",this.onCloseFS);this._sendActionResponse(null,"reached");this._afterRender()},_createFSDiv:function(a){var b=document.createElement("div");var d=document.createElement("div");d.classList.add("z1_fullscreen_content");d.innerHTML=a.content;a=document.createElement("div");var c=document.createElement("span");c.setAttribute("id","z1FSCloseBtn");c.classList.add("z1_fs_close_btn");c.innerHTML="<b>&nbsp;</b>";a.appendChild(c);
a.setAttribute("id","fs_modal_close");a.classList.add("z1_fs_close_btn_container");b.appendChild(a);b.appendChild(d);a=this._getContainerClass()||"z1_fullscreen_container";this._contentDiv.classList.add(a);this._contentDiv.appendChild(b);window.getComputedStyle(this._contentDiv).left;window.getComputedStyle(this._contentDiv).right;this._contentDiv.classList.add("z1_end_transition_style");this._handleFSEvents(d)},_handleFSEvents:function(a){var b=this;a.addEventListener("scroll",function(a){window.document.body.style.position=
"relative";window.document.body.style.overflowY="hidden"},{passive:!1,capture:!1});a.addEventListener("wheel",function(a){window.document.body.style.position="relative";window.document.body.style.overflowY="hidden"},{passive:!1,capture:!1});b.Z1_DOM_EVENTS.split(",").map(function(d){a.addEventListener(d,function(a){if(a){var d=a.target||a.srcElement;b._resetMetaTagValues();b._processMetaTag(d);b._link&&""!=b._link?(b.Z1_LINK_VAL=b._link,b._track&&""!=b._track&&-1!=b._track.search(b.Z1_PUSH_EVT)&&
b._onAction(a,b._track)):b._track&&""!=b._track&&-1!=b._track.search(b.Z1_PUSH_EVT)?b._onAction(a,b._track):d&&d.getAttribute("href")&&d.getAttribute("href")===b.Z1_CLOSE?(b._onAction(a,d.getAttribute("href")),b._sendActionResponse(null,"dismissed")):d&&d.getAttribute(b.Z1_CLOSE_ATTR)&&d.getAttribute(b.Z1_CLOSE_ATTR)===b.Z1_CLOSE?(b._onAction(a,d.getAttribute(b.Z1_CLOSE_ATTR)),b._sendActionResponse(null,"dismissed")):b._deepLink&&""!=b._deepLink&&b._onAction(a,b._deepLink);window.document.body.style.overflowY=
""}a.stopPropagation();a.preventDefault()},{passive:!1,capture:!1})})},_createArticle:function(){this._contentDiv.style.display="block";this._list=this._msgData.message;this._actionId=this._msgData.actionId;this._beforeRender();var a=this._getTargetResourcePath("kblist");this._loadResource(a,"listView")},_createAppbox:function(){this._contentDiv.style.display="block";this._list=this._msgData.message;this._beforeRender();var a=this._getTargetResourcePath("kblist");this._loadResource(a,"listView")},
_beforeRender:function(){var a="beforeRender_"+this._type.toLowerCase();if(this._lifecycleCB&&this._lifecycleCB[a])(0,this._lifecycleCB[a])(this._actionId,this._contentData,this._contentLink)},_afterRender:function(){var a="afterRender_"+this._type.toLowerCase();if(this._lifecycleCB&&this._lifecycleCB[a])(0,this._lifecycleCB[a])(this._actionId,this._contentData,this._contentLink)},_takeBannerAction:function(a){if(a){var b=a.target||a.srcElement;this._resetMetaTagValues();this._processMetaTag(b);this._link&&
""!=this._link?(this.Z1_LINK_VAL=this._link,this._track&&""!=this._track&&-1!=this._track.search(this.Z1_PUSH_EVT)&&this._onAction(a,this._track)):this._track&&""!=this._track&&-1!=this._track.search(this.Z1_PUSH_EVT)?this._onAction(a,this._track):b&&b.getAttribute("href")&&-1!=b.getAttribute("href").search(this.Z1_PUSH_EVT)?this._onAction(a,b.getAttribute("href")):b&&b.getAttribute("href")&&b.getAttribute("href")===this.Z1_CLOSE?(this._onAction(a,b.getAttribute("href")),this._sendActionResponse(null,
"dismissed")):b&&b.getAttribute(this.Z1_CLOSE_ATTR)&&b.getAttribute(this.Z1_CLOSE_ATTR)===this.Z1_CLOSE?(this._onAction(a,b.getAttribute(this.Z1_CLOSE_ATTR)),this._sendActionResponse(null,"dismissed")):this._deepLink&&""!=this._deepLink&&(this._onAction(a),this._removeBannerAnimationCss());a.stopPropagation();a.preventDefault()}},_onAction:function(a,b){switch((b&&""!=b?this._findActionType(b):this._findActionType(this._deepLink)).toLowerCase()){case "pushevent":b=b&&""!=b?this._getPushEventInfo(b):
this._getPushEventInfo(this._deepLink);h&&h._pushEvent(b[0],b[1]);this._sendActionResponse(null,"interacted");this._close&&this._onAction(a,this.Z1_CLOSE);break;case "deeplink":window.open(this._deepLink,"_blank");this._sendActionResponse(null,"interacted");this._onAction(a,this.Z1_CLOSE);break;case "close":if(this._closeView(a),a="afterClose_"+this._type.toLowerCase(),this._lifecycleCB&&this._lifecycleCB[a])(0,this._lifecycleCB[a])(this._actionId,this._contentData,this._contentLink)}},_findActionType:function(a){if(!a||
""===a)return"close";(a?a.startsWith(this.Z1_PROTOCOL):a)?(a=a.substring(this.Z1_PROTOCOL.length),-1!=a.indexOf("?")&&(a=a.split("?")[0])):a="deepLink";return a},_closeView:function(a){this._clearContent();switch(this._type.toLowerCase()){case "banner":clearTimeout(this._bannerTimer);this._removeBannerAnimationCss();break;case "message":this.closeModal(a);break;case "fullscreen":this.closeFullScreen(a);break;case "kb":case "faq":case "appbox":this.closeArticleList()}},_openLink:function(){if(this.Z1_LINK_VAL&&
""!=this.Z1_LINK_VAL){var a=this.Z1_LINK_VAL;this.Z1_LINK_VAL="";var b=this._getParameterByName("target",a);window.open(a,b)}},_getParameterByName:function(a,b){if(b)return a=a.replace(/[\[\]]/g,"\\$&"),(a=(new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)")).exec(b))?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},_getPushEventInfo:function(a){a=a.substring(a.indexOf("pushEvent?")+10).split("&");for(var b=[],d={},c=0;c<a.length;c++){var e=a[c];-1!=e.indexOf("=")?(e=e.split("="),d[e[0]]=e[1]):b.push(e)}d&&
b.push(d);return b},_removeBannerAnimationCss:function(){"block"==this._contentDiv.style.display&&(this._contentDiv.style.display="none",this._contentDiv.style.removeProperty?(this._contentDiv.style.removeProperty("top"),this._contentDiv.style.removeProperty("bottom"),this._contentDiv.style.removeProperty("left"),this._contentDiv.style.removeProperty("right")):(this._contentDiv.style.removeAttribute("top"),this._contentDiv.style.removeAttribute("bottom"),this._contentDiv.style.removeAttribute("left"),
this._contentDiv.style.removeAttribute("right")),this._contentDiv.removeAttribute("class"))},_openModal:function(a,b,d,c){d=document.createElement("div");d.setAttribute("id","modal_wrapper");d.classList.add("z1_modal_wrapper");d.classList.add("z1_flex_center_1");var e=document.createElement("div");e.setAttribute("id","modal_window");e.classList.add("z1_modal_window");e.classList.add("z1_cols_nowrap_edge");c&&e.classList.add("modal_window_"+c);c=document.createElement("div");var f=document.createElement("span");
f.innerHTML=a;f.setAttribute("id","modal_title");f.classList.add("z1_modal_title");a=document.createElement("div");var l=document.createElement("span");l.setAttribute("id","z1Closelabel");l.classList.add("z1_modal_close_label");l.innerHTML="";var g=document.createElement("span");g.setAttribute("id","z1CloseBtn");g.classList.add("z1_modal_close_btn");g.innerHTML="<b>&nbsp;</b>";a.appendChild(l);a.appendChild(g);a.setAttribute("id","modal_close");a.classList.add("z1_modal_close_btn_container");c.appendChild(f);
c.appendChild(a);c.setAttribute("id","z1_modal_header");c.classList.add("z1_modal_header");e.appendChild(c);d.appendChild(e);this._contentDiv.appendChild(d);var h=this;document.addEventListener?h.Z1_DOM_EVENTS.split(",").map(function(a){document.getElementById("modal_close").addEventListener(a,function(a){h.closeModal(a);h._sendActionResponse(null,"dismissed")},!1)}):document.getElementById("modal_close").attachEvent("onclick",function(a){h.closeModal(a);h._sendActionResponse(null,"dismissed")});
d.classList.add("overlay");e.appendChild(b)},closeModal:function(a){var b=document.getElementById("modal_wrapper");b&&(b.className="",b.parentNode&&b.parentNode.removeChild(b));window.document.body.style.overflowY="";if(a)a.preventDefault?a.preventDefault():a.returnValue=!1;else return!1},onCloseFS:function(a){this.closeFullScreen(a);this._sendActionResponse(null,"dismissed")},closeFullScreen:function(a){this._contentDiv&&(this._contentDiv.innerHTML="",this._contentDiv.style.display="none",this._contentDiv.classList.remove("z1_fullscreen_container"),
this._contentDiv.classList.remove("z1_end_transition_style"));if(a)a.preventDefault?a.preventDefault():a.returnValue=!1;else return!1},closeArticle:function(a){if(this._contentDiv&&("kb"==this._type||"faq"==this._type||"appbox"==this._type))if(this._showListView)this._onAction(a);else{this._hideKBDetail(!0);if(a=document.querySelector(".z1_article_frame"))a.src="about:blank";if(a=document.getElementById("z1_articles_total_num")){var b=document.querySelectorAll(".z1_list_row");a.innerHTML="appbox"===
this._type?b.length+" Inbox Messages":this._list.length+" Articles Found"}this._hideKBList(!1)}},closeArticleList:function(a){this._contentDiv&&this._showListView&&(this._contentDiv.innerHTML="",this._contentDiv.style.display="none",this._contentDiv.classList.remove("z1_fullscreen_container"),this._contentDiv.classList.remove("z1_end_transition_style"))},_displayKBHeader:function(){var a=document.createElement("div");a.classList.add("z1_article_header");a.classList.add("z1_article_header_flex");var b=
document.createElement("section");b.classList.add("z1_articles_backBtn");b.classList.add("z1_hide");b.setAttribute("id","z1_articles_backBtn");var d=document.createElement("span");d.classList.add("z1_articles_total_num");d.classList.add("z1_articles_total_num_flex");d.setAttribute("id","z1_articles_total_num");var c=document.createElement("section");c.classList.add("z1_article_close_btn");c.setAttribute("id","z1_article_close_btn");c.setAttribute(this.Z1_CLOSE_ATTR,this.Z1_CLOSE);c.innerHTML="<b>&nbsp;</b>";
a.appendChild(b);a.appendChild(d);a.appendChild(c);return a},_displayKBList:function(a){this._hideKBDetail(!0);var b=document.createElement("div"),d=document.createElement("div");d.classList.add("z1_article_list_wrapper");d.innerHTML="";if(0===a.length){var c=document.createElement("div"),e=document.createTextNode("appbox"===this._type?"No Messages in your Inbox":"No matching Articles exist in the system");c.appendChild(e);d.appendChild(c);b.appendChild(d);return b}for(e=0;e<a.length;e++){c=document.createElement("div");
c.classList.add("z1_list_row");c.setAttribute("data-kb-index",e);this.Z1_DOM_EVENTS.split(",").map(function(b){c.addEventListener(b,function(){var b=this.getAttribute("data-kb-index");0<a[b].unread&&(a[b].unread=0);this._viewKB(a[b].id);"faq"!==this._type&&this._sendActionResponse(a[b],"reached")},!1)});if("appbox"===this._type){var f=document.createElement("div");f.classList.add("z1_appbox_leftBar");f.setAttribute("id","z1_appbox_left_div");var g=document.createElement("div");g.setAttribute("id",
"z1_appbox_left_child_div");var h=document.createElement("img");h.setAttribute("id","z1_appbox_down_arrow");h.src="https://d2p4r375zfkzm8.cloudfront.net/html5sdk/3.0.0/z_arrow_down.png";h.style="width:17px";g.appendChild(h);h=document.createElement("div");h.classList.add("deleteBox");h.setAttribute("id","z1_appbox_del_div");var k=document.createElement("img");k.src="https://d2p4r375zfkzm8.cloudfront.net/html5sdk/3.0.0/delete.png";k.style="width:20px";k.setAttribute("id","z1_appbox_del_btn");h.appendChild(k);
f.appendChild(g);f.appendChild(h);c.appendChild(f)}f=document.createElement("div");f.classList.add("z1_list_midContainer");g=document.createElement("h1");"appbox"===this._type&&0<a[e].unread&&g.classList.add("z1_appbox_unread_title");"appbox"===this._type?g.appendChild(document.createTextNode(a[e].subject)):g.appendChild(document.createTextNode(a[e].title));f.appendChild(g);g=document.createElement("div");g.classList.add("dateContainer");"appbox"===this._type&&0<a[e].unread&&g.classList.add("z1_appbox_unread_date");
if("appbox"===this._type){h=new Date(parseInt(a[e].lastUpdateTime));k=10<=h.getMonth()+1?(h.getMonth()+1).toString():"0"+(h.getMonth()+1);var m=10<=h.getDate()?h.getDate().toString():"0"+h.getDate();h=k+"/"+m+"/"+h.getFullYear();g.appendChild(document.createTextNode(h))}else g.appendChild(document.createTextNode(a[e].creationDate));f.appendChild(g);c.appendChild(f);f=document.createElement("div");f.classList.add("z1_list_rightArrow");g=document.createElement("img");g.src="https://d2p4r375zfkzm8.cloudfront.net/html5sdk/3.0.0/arrow_right.png";
g.style="height:22px";f.appendChild(g);c.appendChild(f);d.appendChild(c);b.appendChild(d)}return b},_viewKB:function(a){for(var b=null,d=0;d<this._list.length;d++)if(a===this._list[d].id){b=this._list[d];break}this._showListView=!1;this._showKBDetailView(b)},_showKBDetailView:function(a){this._selectedArticle=a;a="appbox"===this._type?this._getTargetResourcePath("appbox"):this._getTargetResourcePath("kb");this._loadResource(a,"detailView")},_hideKBList:function(a){var b=document.getElementById("z1_list");
b&&(a?(b.style.display="none",this._showListView=!1,this._hideArticleBackBtn(!1)):(b.style.display="block",this._showListView=!0,this._hideArticleBackBtn(!0)))},_hideKBDetail:function(a){var b=document.getElementById("z1_detail");b&&(a?(b.style.display="none",this._showListView=!0):(b.style.display="block",this._showListView=!1))},_hideArticleBackBtn:function(a){var b=document.getElementById("z1_articles_backBtn");b&&(a?b.classList.add("z1_hide"):b.classList.remove("z1_hide"))},_sendActionResponse:function(a,
b){var d={};h&&(d=h._getDeviceCtx(d));d.actionId=this._actionId;"kb"==this._type&&(d.contentId=a?a.id:null);d.actionState=b&&""!=b?b:"reached";var c=this;u.POST("c3/api/v1/actionResponse",d,{}).then(function(a){c._onActionResponseSent(a)},function(a){console.log("ZineOne API Failure: Failed to send an action response! ")})},_onActionResponseSent:function(a){},_getTargetResourcePath:function(a){a="template/"+a+"/html5";var b=h._getDeviceType();return a+"?devicetype="+b},_loadResource:function(a,b){var d=
this;"listView"===b?u.GET(a,{},{}).then(function(a){d._onListViewSuccess.call(d,a)},function(a){console.log("ZineOne API Failure : Failed to load the css ")}):"detailView"===b&&("appbox"===this._type?u.GET(a,{},{}).then(function(a){d._onAppBoxDetailViewSuccess.call(d,a)},function(a){console.log("ZineOne API Failure : Failed to load the css ")}):u.GET(a,{},{}).then(function(a){d._onDetailViewSuccess.call(d,a)},function(a){console.log("ZineOne API Failure : Failed to load the css ")}))},_onListViewSuccess:function(a){var b=
this._displayKBHeader(),d=document.getElementById("z1_list");d||(d=document.createElement("div"),d.setAttribute("id","z1_list"));this._contentDiv.appendChild(b);this._contentDiv.appendChild(d);b=this._displayKBList(this._list).innerHTML;a=a.replace(/{z1_content}/g,b);d.innerHTML=a;this._contentDiv.classList.add("z1_article_container");document.querySelector(".z1_articles_total_num").innerHTML="appbox"===this._type?this._list.length+" Inbox Messages":this._list.length+" Articles Found";var c=this;
document.addEventListener?(c.Z1_DOM_EVENTS.split(",").map(function(a){document.getElementById("z1_article_close_btn").addEventListener(a,function(a){c.closeArticle(a);a.stopPropagation()},!1)}),c.Z1_DOM_EVENTS.split(",").map(function(a){document.getElementById("z1_articles_backBtn").addEventListener(a,function(a){c.closeArticle(a);a.stopPropagation()},!1)})):(document.getElementById("z1_article_close_btn").attachEvent("onclick",function(a){c.closeArticle(a);a.stopPropagation()}),document.getElementById("z1_articles_backBtn").addEventListener("click",
function(a){c.closeArticle(a);a.stopPropagation()},!1));aticleList=document.querySelectorAll(".z1_list_row");var e,f=aticleList.length;for(e=0;e<f;e++)aticleList[e].addEventListener?c.Z1_DOM_EVENTS.split(",").map(function(a){aticleList[e].addEventListener(a,function(a){var b=this.getAttribute("data-kb-index");if(a&&a.srcElement){if((a=a.srcElement)&&a.id&&"z1_appbox_del_btn"===a.id){if("appbox"===c._type){var d=document.querySelectorAll(".z1_list_row");c._onDeleteAppBoxItem(c._list[b].id,a,d.length)}return}if(a&&
a.id&&("z1_appbox_down_arrow"===a.id||"z1_appbox_left_div"===a.id||"z1_appbox_left_child_div"===a.id)&&"appbox"===c._type)return}if(0<c._list[b].unread)for(a=c._list[b].unread=0;a<this.childNodes.length;a++)if("z1_list_midContainer"===this.childNodes[a].className){this.childNodes[a].childNodes[0].classList.remove("z1_appbox_unread_title");this.childNodes[a].childNodes[1].classList.remove("z1_appbox_unread_date");break}c._viewKB.call(c,c._list[b].id);"faq"!==c._type&&c._sendActionResponse.call(c,c._list[b],
"interacted")},!1)}):aticleList[e].attachEvent&&aticleList[e].attachEvent("click",function(){var a=this.getAttribute("data-kb-index");if(evt&&evt.srcElement){var b=evt.srcElement;if(b&&b.id&&"z1_appbox_del_btn"===b.id){"appbox"===c._type&&c._onDeleteAppBoxItem(c._list[a].id,b,f);return}}if(0<c._list[a].unread)for(b=c._list[a].unread=0;b<this.childNodes.length;b++)if("z1_list_midContainer"===this.childNodes[b].className){this.childNodes[b].childNodes[0].classList.remove("z1_appbox_unread_title");this.childNodes[b].childNodes[1].classList.remove("z1_appbox_unread_date");
break}c._viewKB.call(c,c._list[a].id);"faq"!==c._type&&c._sendActionResponse.call(c,c._list[a],"interacted")});this._sendActionResponse(null,"reached");this._showListView=!0;this._afterRender()},_onDeleteAppBoxItem:function(a,b,d){var c=this;a&&"appbox"===this._type&&u.POST("c3/api/v1/chat/delete",{id:a},{}).then(function(a){c._removeAppBoxMsg(b,d)},function(a){console.log("ZineOne API Failure : Deletion error ")})},_removeAppBoxMsg:function(a,b){if(a&&(this._sendActionResponse(null,"dismissed"),
a=a.parentNode.parentNode.parentNode?a.parentNode.parentNode.parentNode:a.parentElement.parentElement.parentElement)){var d=document.getElementsByClassName("z1_article_list_wrapper");d&&d[0]&&d[0].removeChild(a)}document.getElementById("z1_articles_total_num").innerHTML=b-1+" Inbox Messages"},_onDetailViewSuccess:function(a){var b=document.getElementById("z1_detail");b?b.innerHTML="":(b=document.createElement("div"),b.setAttribute("id","z1_detail"));this._contentDiv.appendChild(b);a=a.replace(/%z1.content.url%/g,
this._selectedArticle?this._selectedArticle.contentUrl:"");b.innerHTML=a;this._showArticleHeader();this._hideKBList(!0);this._hideKBDetail(!1)},_onAppBoxDetailViewSuccess:function(a){var b=this;"appbox"===this._type&&u.GET("c3/api/v1/chat/chatSession?id="+this._selectedArticle.id+"&client=customer&days=7",{},{}).then(function(d){b._onAppBoxDataSuccess.call(b,d,a)},function(a){console.log("ZineOne API Failure: Failure with the chat API")})},_onAppBoxDataSuccess:function(a,b){var d="",c=document.getElementById("z1_detail");
c?c.innerHTML="":(c=document.createElement("div"),c.setAttribute("id","z1_detail"));this._contentDiv.appendChild(c);if((a=JSON.parse(a))&&0<a.length)for(var e=1;e<a.length;e++)d=a[e].data;a=b.replace(/%z1.appbox.detail%/g,d);c.innerHTML=a;this._showArticleHeader();this._hideKBList(!0);this._hideKBDetail(!1)},_showArticleHeader:function(){var a=document.getElementById("z1_articles_total_num");a&&(a.innerHTML="appbox"===this._type?this._selectedArticle.subject:this._selectedArticle.title)},_processActionMappingOnClick:function(a,
b){if(this._evaluatePageSelector(b.pageSelector)&&(b.eventName.toLowerCase()===a.type||"click"===b.eventName.toLowerCase()&&"touchstart"===a.type.toLowerCase())){var d=this._evaluateDOMSelector(b.domSelector),c=null;if(d&&d.length)for(var e=0;e<d.length;e++){if(this._isTriggerElement(d[e],a.srcElement)){c=d[e];break}}else c=d;if(null!==c)try{if(this._isDescendant(c,a.srcElement))if(b.actionType.toLowerCase()===this.ACTION_MAPPING_TYPE_PUSH)try{var f=this._getActionMappingParams(b.pushParams);h._pushEvent(b.pushEventName,
f)}catch(N){console.log("ZineOne: Error in executing custom tag when sending an event to Zineone cloud(on click / on change).")}else if(b.actionType.toLowerCase()===this.ACTION_MAPPING_TYPE_SCRIPT)try{if(b.methodName)window[b.methodName](a)}catch(N){console.log("ZineOne: Error in executing custom tag's script (on click /on change).")}}catch(N){console.log("ZineOne: Error in executing custom tag when sending an event to Zineone cloud(on click / on change).")}}},_processActionMappingOnLoad:function(a,
b){if(this._evaluatePageSelector(b.pageSelector)&&b.eventName.toLowerCase()===a)if(b.actionType.toLowerCase()===this.ACTION_MAPPING_TYPE_PUSH)try{var d=this._getActionMappingParams(b.pushParams);h._pushEvent(b.pushEventName,d)}catch(l){console.log("ZineOne: Error in executing custom tag when sending an event to Zineone cloud(on load).")}else if(b.actionType.toLowerCase()===this.ACTION_MAPPING_TYPE_SCRIPT)try{if(b.methodName)window[b.methodName](a)}catch(l){console.log("ZineOne: Error in executing custom tag's script (on load).")}},
_processActionMappingOnDataLayerChange:function(a,b,d){if(b.eventName.toLowerCase()===a&&this._evaluateVariableSelector(b.variableSelector,d.toLowerCase()))if(b.actionType.toLowerCase()===this.ACTION_MAPPING_TYPE_PUSH)try{var c=this._getActionMappingParams(b.pushParams);h._pushEvent(b.pushEventName,c)}catch(t){console.log("ZineOne: Error in executing custom tag when sending an event to Zineone cloud(on data layer change).")}else if(b.actionType.toLowerCase()===this.ACTION_MAPPING_TYPE_SCRIPT)try{if(b.methodName)window[b.methodName](a)}catch(t){console.log("ZineOne: Error in executing custom tag's script (on data layer change).")}},
_isDescendant:function(a,b){if(void 0===a||void 0===b||null===a||null===b)return!1;if(a==b)return!0;for(b=b.parentNode;null!=b;){if(b==a)return!0;b=b.parentNode}return!1},_isTriggerElement:function(a,b){return a==b?!0:!1},_evaluatePageSelector:function(a){var b=a&&a.type?a.type:"";if(""!=b&&"all"===b.toLowerCase())return!0;if(""!=b&&"pgname"===b.toLowerCase()){b=a.condition.trim();if("equals"===b.toLowerCase())return b=Z1.window.browserInfo.pagePath.toLowerCase(),a=a.val.toLowerCase(),b.endsWith(a);
if("in"===b.toLowerCase())return a=a.val.split("|"),b=[],a.length&&(b=a.filter(function(a){return Z1.window.browserInfo.pagePath.toLowerCase().includes(a.toLowerCase())})),0<b.length;if("starts"===b.toLowerCase())return Z1.window.browserInfo.pagePath.toLowerCase().startsWith(a.val.toLowerCase());if("ends"===b.toLowerCase())return Z1.window.browserInfo.pagePath.toLowerCase().endsWith(a.val.toLowerCase());if("contains"===b.toLowerCase())return Z1.window.browserInfo.pagePath.toLowerCase().includes(a.val.toLowerCase())}},
_evaluateDOMSelector:function(a){var b=null;if(a&&a.type)switch(a.type){case "id":b=document.querySelector("#"+a.val);break;case "class":b=document.querySelector("."+a.val);break;case "query":b=document.querySelectorAll(a.val)}return b},_evaluateVariableSelector:function(a,b){var d=a&&a.type?a.type.toLowerCase():"";if(""!=d&&"any"===d.toLowerCase())return!0;if(""!=d&&"varname"===d.toLowerCase())if(d=a.condition.trim(),"equals"===d.toLowerCase())for(key in a=a.val.toLowerCase(),h._dataLayer){if(key.toLowerCase()===
b&&key.toLowerCase()===a)return!0}else if("in"===d.toLowerCase())for(key in b=a.val.toLowerCase().split("|"),h._dataLayer)if(b.includes(key.toLowerCase()))return!0},_getActionMappingParams:function(a){var b={};if(a)for(key in a){var d=a[key].split("|");if(d[0].trim().toLowerCase()===this.ACTION_MAPPING_PARAM_CONSTANT)b[key]=d[1].trim();else if(d[0].trim().toLowerCase()===this.ACTION_MAPPING_PARAM_COMPUTED)b[key]=eval(d[1].trim());else if(d[0].trim().toLowerCase()===this.ACTION_MAPPING_PARAM_DATALAYER){if(h._dataLayer)for(datakey in h._dataLayer)if(key===
datakey){b[key]=h._dataLayer[datakey];break}}else d[0].trim().toLowerCase()===this.ACTION_MAPPING_PARAM_EVENT&&(b[key]=eval(d[1].trim()))}return b},_bindCss:function(a){var b=document.head||document.getElementsByTagName("head")[0],d=document.createElement("style");d.type="text/css";d.id="z1_style";d.styleSheet?d.styleSheet.cssText=a:d.appendChild(document.createTextNode(a));b.appendChild(d)},_clearContent:function(){var a=this._getAllElements("data-zineone-widget");if(a&&0<a.length)for(var b=0;b<
a.length;b++)a[b].innerHTML=""},_hideContent:function(){var a=this._getAllElements("data-zineone-widget");if(a&&0<a.length)for(var b=0;b<a.length;b++)a[b].style.display="none"},_removeStyle:function(){var a=document.getElementById("z1_style");a&&a.parentNode&&a.parentNode.removeChild(a)},_getElementsByAttribute:function(a,b){for(var d=document.getElementsByTagName("*"),c=[],e=0,f,g=null;f=d[e++];)f.getAttribute(a)&&c.push(f);if(c&&0<c.length)for(d=0;d<c.length;d++)c[d].getAttribute(a)===b&&(g=c[d]);
return g},_getAllElements:function(a){for(var b=document.getElementsByTagName("*"),d=[],c=0,e;e=b[c++];)e.getAttribute(a)&&d.push(e);return d}},F={listener:{onMessage:function(a){if("raw"==a.type){if(p._widgetCB)for(var b in p._widgetCB)if(b===a.type){var d=a&&a.info&&a.info.__link?a.info.__link:null;p._widgetCB[b](a.message,d)}}else{p._msgData=a;p._type=a.type;p._actionId=null;p._deepLink="";p._clearContent();p._hideContent();p._removeStyle();p._contentDiv=p._getElementsByAttribute("data-zineone-widget",
"z1_content_widget");if(!(1<=p._msgData.__call_cnt__)&&p._widgetCB)for(b in p._widgetCB)if(b===p._type){"raw"!=b&&("kb"===b?(p._actionId=p._msgData.info&&p._msgData.info.actionId?p._msgData.info.actionId:null,p._sendActionResponse(p._msgData,"reached")):(p._actionId=p._msgData.info&&p._msgData.info.actionId?p._msgData.info.actionId:null,p._sendActionResponse(null,"reached")));d=null;p._msgData&&p._msgData.info&&(d=p._msgData.info.__link);p._msgData.__call_cnt__=1;p._widgetCB[b](p._msgData,d);return}"banner"===
p._msgData.type?p._createBanner():"message"===p._msgData.type?p._createAlert():"fullscreen"===p._msgData.type?p._createFullScreen():"kb"===p._msgData.type||"faq"===p._msgData.type?p._createArticle():"appbox"===p._msgData.type&&p._createAppbox()}}},init:function(a){f||(p._printZ1WidgetVersion(),a||(p._lu=R.instance(),a=p._lu),a.connect(this.listener))},registerWidgetHandler:function(a,b){p._widgetCB[a]=b},setProperty:function(a){this._isApiDisabled||a&&""!=a&&p._setProperty(a)},setConfiguration:function(a){p._configMap=
a},widgetLifeCycleHandler:function(a,b,d){p._lifecycleCB[a+"_"+b]=d}};"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(a){return this.slice(0,a.length)==a});_printSdkVersion=function(){try{e&&console.log("ZineOne sdk version is : 2023.4.5.1")}catch(a){e&&(console.log("ZineOne: Unable to print SDK version due to following error"),console.log(""+a.name+": "+a.message))}};_setApiKey=function(a){try{g=a}catch(b){e&&(console.log("ZineOne: Unable to set api key due to following error"),
console.log(""+b.name+": "+b.message))}};_getApiKey=function(){return g};_setAccessToken=function(a){try{m=a}catch(b){e&&(console.log("ZineOne: Unable to set access token due to following error"),console.log(""+b.name+": "+b.message))}};_getAccessToken=function(){return m};_setDomainName=function(a){try{r=a}catch(b){e&&(console.log("ZineOne: Unable to set domain name due to following error"),console.log(""+b.name+": "+b.message))}};_setHostName=function(a){try{var b=r&&""!=r?r:"zineone.com";if(a&&
""!=a)u._hostName=a,u.URL_HOST="localhost"!==a.toLowerCase()?a+"."+b+"/":a+":8888/";else{var d=_getApiKey().substring(0,_getApiKey().indexOf("@"));u.URL_HOST="zineone.com"!=b?"localhost"!==d.toLowerCase()?b+"/":d+":8888/":"localhost"!==d.toLowerCase()?d+"."+b+"/":d+":8888/"}}catch(l){e&&(console.log("ZineOne: Unable to set host name due to following error"),console.log(""+l.name+": "+l.message))}};_getHostName=function(){try{return u.URL_HOST}catch(a){e&&(console.log("ZineOne: Unable to return host name due to following error"),
console.log(""+a.name+": "+a.message))}};_generateUUID=function(){var a=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(b){var d=(a+16*Math.random())%16|0;a=Math.floor(a/16);return("x"==b?d:d&7|8).toString(16)})};_isLocationEnabled=function(){return w};_getZ1Widget=function(){if(F)return F};_getInboxCount=function(a){try{return h||(h=x,h.forceConnect()),u.GET("c3/api/v1/chat/inboxCount?profileId="+h._profileId,{},{}).then(function(b){(b=JSON.parse(b))&&b.status&&
"fail"===b.status||a.call(this,{read:b.read,unread:b.count})},function(a){console.log("ZineOne API Failure : Failed to get the inbox count!")}),null}catch(b){e&&(console.log("ZineOne: Unable to get Inbox count due to following error"),console.log(""+b.name+": "+b.message))}};_getInfo=function(a){try{k=a}catch(b){e&&(console.log("ZineOne: Unable to fetch info data due to following error"),console.log(""+b.name+": "+b.message))}};_fetchInboxData=function(){try{var a="";h||(h=x,h.forceConnect());a="c3/api/v1/chat/inbox?profileId="+
h._profileId;var b=this;u.GET(a,{},{}).then(function(a){a=JSON.parse(a);b._onInboxDataSuccessful(a)},function(a){e&&console.log("ZineOne API Failure: Failed to fetch inbox data!")})}catch(d){e&&(console.log("ZineOne: Unable to fetch Inbox data due to following error"),console.log(""+d.name+": "+d.message))}};_onInboxDataSuccessful=function(a){try{if(a={type:"appbox",message:a},F&&F.listener)F.listener.onMessage(a)}catch(b){e&&(console.log("ZineOne: Unable to send Inbox success due to following error"),
console.log(""+b.name+": "+b.message))}};_showFAQ=function(){try{var a=navigator.language?navigator.language:navigator.browserLanguage?navigator.browserLanguage:navigator.userLanguage;a=a.split("-");var b="c3/api/v1/faq?os=android&status=published&language="+a[0];""!=_getApiKey()?b+="&apikey="+_getApiKey():""!=_getAccessToken()&&(b+="&accesstoken="+_getAccessToken());var d=this;u.GET(b,{},{}).then(function(a){(a=JSON.parse(a))&&a.status&&"fail"===a.status||d._onFAQSuccessful(a)},function(a){console.log("ZineOne API Failure: Failed to collect all FAQ items!")})}catch(l){e&&
(console.log("ZineOne: Unable to show FAQ due to following error"),console.log(""+l.name+": "+l.message))}};_onFAQSuccessful=function(a){try{for(var b=0;b<q.length;b++){var d=q[b];if(null!=d._listeners&&0<d._listeners.length)for(var c=0;c<d._listeners.length;c++){var f=h._massageData(a.faqs);d._listeners[c].onMessage({type:"faq",message:f})}}}catch(E){e&&(console.log("ZineOne: Unable to send FAQ success due to following error"),console.log(""+E.name+": "+E.message))}};_openSession=function(){try{h=
x,h.forceConnect()}catch(a){e&&(console.log("ZineOne: Unable to open the session due to following error"),console.log(""+a.name+": "+a.message))}};_openBroadcast=function(){try{h=x;var a=null;window&&window.location&&window.location.hostname&&(a=window.location.hostname);var b=a||_getApiKey()||_getAccessToken()||"";h._channelPrefix=b;h.__setChannelBroadcaster(b)}catch(d){e&&(console.log("ZineOne: Unable to open a broadcast channel due to following error:"),console.log(""+d.name+": "+d.message))}};
_closeChannels=function(){try{h=x,h.__closeChannels()}catch(a){e&&(console.log("ZineOne: Unable to open a broadcast channel due to following error:"),console.log(""+a.name+": "+a.message))}};_registerChannelListener=function(a){try{h||(h=x);var b=null;window&&window.location&&window.location.hostname&&(b=window.location.hostname);var d=h._channelPrefix||b||_getApiKey()||_getAccessToken()||"";h.__registerChannelListener(a,d)}catch(l){e&&(console.log("ZineOne: Unable to register a listener due to the following error:"),
console.log(""+l.name+": "+l.message))}};_setLocation=function(){try{h=x;var a=_isLocationEnabled();e&&console.debug("Location status check");h._getULocation();a&&null==h._glTimer&&(e&&console.debug("Location is enabled, updating the location check timer"),h._setGLInterval())}catch(b){e&&(console.log("ZineOne: Unable to check and set location due to following error"),console.log(""+b.name+": "+b.message))}};_setProfileAttributes=function(a){a=void 0===a?{}:a;var b=JSON.stringify(a);"{"==b.charAt(0)&&
"}"==b.charAt(b.length-1)&&(b=Object.keys(a),0<b.length&&b.forEach(function(b){var c=void 0!=M[b.toLowerCase()]?M[b.toLowerCase()]:b;c==M.id?_onSetCustomerId(a[b],{shouldConnect:!1}):_onSetCustomKey(c,a[b],{shouldConnect:!1})}))};_onSetCustomerId=function(a,b){b=void 0===b?{}:b;try{var c=void 0!=b.shouldConnect?b.shouldConnect:!0;h||(h=x);h._shouldConnectWithKey("z1_cust_id",a)?h._getProfileKey()&&""!=h._getProfileKey()?h._getProfileKey()!=a&&(h._connectInfo.customKey={},h._setProfileKey(a),c&&h.forceConnect()):
(h._setProfileKey(a),c&&h.forceConnect()):(h._connectInfo.customKey={},h._setProfileKey(a),c&&h._connect())}catch(l){e&&(console.log("ZineOne: Unable to set customer id due to following error"),console.log(""+l.name+": "+l.message))}};_onSetCustomKey=function(a,b,c){c=void 0===c?{}:c;try{var d=void 0!=c.shouldConnect?c.shouldConnect:!0;h||(h=x);h._connectInfo.customKey[a]=b;var f=JSON.stringify(h._connectInfo.customKey);h._shouldConnectWithKey("z1_cust_key",f)?d&&h.forceConnect():d&&h._connect()}catch(E){e&&
(console.log("ZineOne: Unable to set custom key due to following error"),console.log(""+E.name+": "+E.message))}};_createMessagingLayer=function(){try{p&&(p._clearContent(),p._hideContent()),H=!1}catch(a){e&&(console.log("ZineOne: Unable to create a messaging layer due to following error"),console.log(""+a.name+": "+a.message))}};_pushEvent=function(a,b){try{h||(h=x,h.forceConnect()),h._pushEvent(a,b)}catch(d){e&&(console.log("ZineOne: Unable to push an event due to following error"),console.log(""+
d.name+": "+d.message))}};_checkStorageStatus=function(){try{"object"!==typeof localStorage||"object"!==typeof sessionStorage?(_pushEvent("z1sdknotification",{errorMsg:"Local or Session Storage is not an object",errorName:"z1.TypeError",status:"ERROR"}),f=!0):(localStorage.setItem("isAvailable","isTest"),localStorage.getItem("isAvailable"),localStorage.removeItem("isAvailable"),sessionStorage.setItem("isAvailable","isTest"),sessionStorage.getItem("isAvailable"),sessionStorage.removeItem("isAvailable"))}catch(a){_pushEvent("z1sdknotification",
{errorMsg:a.message||"",errorName:a.name||"",status:"ERROR"}),f=!0}};_isLocalStorageAvailable=function(){try{if("object"!==typeof localStorage)return!1;localStorage.setItem("isAvailable","isTest");var a=localStorage.getItem("isAvailable");localStorage.removeItem("isAvailable");return"isTest"===a}catch(b){return!1}};_localStorageSetItem=function(a,b){try{C&&(C[a]=b),_isLocalStorageAvailable()&&localStorage.setItem(a,b)}catch(d){e&&(console.log("ZineOne: Unable to write to localStorage, retaining information in SDK"),
console.log(a),console.log(b))}};_localStorageGetItem=function(a,b){b=void 0===b?!1:b;var c=_isLocalStorageAvailable();c||(b=!1);if(!b&&C&&C[a])return C[a];try{return c?(v=localStorage.getItem(a),C&&(C[a]=v),v):null}catch(l){e&&console.log("ZineOne: Unable to get item "+a+" from localStorage")}};_isSessionStorageAvailable=function(){try{if("object"!==typeof sessionStorage)return!1;sessionStorage.setItem("isAvailable","isTest");var a=sessionStorage.getItem("isAvailable");sessionStorage.removeItem("isAvailable");
return"isTest"===a}catch(b){return!1}};_sessionStorageSetItem=function(a,b){try{D&&(D[a]=b),_isSessionStorageAvailable()&&sessionStorage.setItem(a,b)}catch(d){e&&(console.log("ZineOne: Unable to write to localStorage, retaining information in SDK"),console.log(a),console.log(b))}};_sessionStorageGetItem=function(a,b){b=void 0===b?!1:b;var c=_isSessionStorageAvailable();c||(b=!1);if(!b&&D&&D[a])return D[a];try{return c?(v=sessionStorage.getItem(a),D&&(D[a]=v),v):null}catch(l){e&&console.log("ZineOne: Unable to get item "+
a+" from localStorage")}};isBrowserSupported=function(){return!0};var P=function(){var a=document.body;_loopThroughGlobalTriggers=function(a){if(h&&h._globalTriggers&&0<h._globalTriggers.length)for(var b=0;b<h._globalTriggers.length;b++)p._processActionMappingOnClick(a,h._globalTriggers[b])};a.onchange=function(a){_loopThroughGlobalTriggers(a)};_onBodyAction=function(a){_loopThroughGlobalTriggers(a);p._handleBodyClickEvents(a)};a.addEventListener("click",this._onBodyAction.bind(this),!1)};if("complete"!==
document.readyState)var S=setInterval(function(){"complete"===document.readyState&&(clearInterval(S),P())},100);else P();window.onbeforeunload=function(a){if(h&&h._globalTriggers&&0<h._globalTriggers.length)for(a=0;a<h._globalTriggers.length;a++)p._processActionMappingOnLoad("unload",h._globalTriggers[a]);h&&h._broadCast&&_closeChannels()};return{acceptLocation:function(a){isBrowserSupported()&&this.isInitialized()&&console.log("Zineone: The API to accept location has been deprecated.")},addCustomerInfo:function(a,
b){if(!f&&this.isInitialized()&&isBrowserSupported())try{h&&h._addProfileInfo(a,b)}catch(d){console.log("ZineOne : Error adding custom attributes to a user's profile.")}},addData:function(a,b){if(!f&&this.isInitialized()&&isBrowserSupported())try{h||(h=x),h._addData(a,b)}catch(d){console.log("ZineOne : Error adding parameter to Zineone's data layer.")}},removeData:function(a){if(!f&&this.isInitialized()&&isBrowserSupported())try{h&&h._removeData(a)}catch(b){console.log("ZineOne: Error removing data layer key.")}},
getData:function(a){if(!f&&this.isInitialized()&&isBrowserSupported())try{if(h)return h._getData(a)}catch(b){console.log("ZineOne : Error retrieving parameter from Zineone's data layer.")}},createMessagingLayer:function(){if(!f&&this.isInitialized()&&isBrowserSupported())try{_createMessagingLayer()}catch(a){console.log("ZineOne : Error creating a messaging boundary for accepting responses from backend.")}},enableMessaging:function(){f||this.isInitialized()&&this._isDebugOn&&console.log("ZineOne: The API to enable messaging has been deprecated.")},
enablePushNotification:function(a,b){console.log("ZineOne: The API to enable push notifications has been deprecated.")},getDeviceId:function(){if(!f&&this.isInitialized()&&isBrowserSupported())try{return _localStorageGetItem("z1_deviceId")?_localStorageGetItem("z1_deviceId"):null}catch(a){console.log("ZineOne : Error returning user's Device ID.")}},getInboxCount:function(a){if(!f&&this.isInitialized()&&isBrowserSupported())try{_getInboxCount(a)}catch(b){console.log("ZineOne : Error returning total number of read and unread messages found in the user\u2019s inbox.")}},
getInfo:function(a){if(!f&&this.isInitialized()&&isBrowserSupported())try{_getInfo(a)}catch(b){console.log("ZineOne : Error returning user's identification.")}},getZ1Widget:function(){if(isBrowserSupported())try{return _getZ1Widget()}catch(a){console.log("ZineOne : Error fetching the Zineone widgetry.")}},registerChannelListener:function(a){if(!f&&isBrowserSupported()){a||e&&console.warn("ZineOne: Cannot register an undefined listener.");try{_registerChannelListener(a)}catch(b){console.log("ZineOne : Error fetching channel.")}}},
isDebugOn:function(a){try{e=a}catch(b){console.log("ZineOne : Error setting the SDK debugger.")}},initialize:function(a,b){b=void 0===b?{}:b;if(!f&&!this.isInitialized()&&isBrowserSupported())try{n=!0,_printSdkVersion(),_setApiKey(a),_setHostName(),_openBroadcast(),_setProfileAttributes(b),_openSession(),F.init(),this.createMessagingLayer()}catch(d){n=!1,console.debug("ZineOne : Error initializing ZineOne SDK"),e&&console.debug(d)}},initializeWithToken:function(a,b){b=void 0===b?{}:b;if(!f&&!this.isInitialized()&&
isBrowserSupported())try{n=!0;_printSdkVersion();var c=atob(a);a=[];c&&""!=c&&(a=c.split("|"));if(2>a.length)throw Error("Invalid Access Token");_setAccessToken(a[1]);var e=a[0].includes("zineone.com")?a[0].slice(0,a[0].indexOf(".zineone.com")):void 0!=r&&""!=r&&a[0].includes(r)?a[0].slice(0,a[0].indexOf("."+r)):a[0];_setHostName(e);_openBroadcast();_setProfileAttributes(b);_openSession();F.init();this.createMessagingLayer()}catch(t){n=!1,console.log("ZineOne : Error initializing ZineOne SDK")}},
openInbox:function(){if(!f&&this.isInitialized()&&isBrowserSupported())try{_fetchInboxData()}catch(a){console.log("ZineOne: Error fetching User's Appbox Messages.")}},openFAQ:function(){if(!f&&this.isInitialized()&&isBrowserSupported())try{_showFAQ()}catch(a){console.log("ZineOne: Error opening FAQ's.")}},pushEvent:function(a,b){if(!f&&this.isInitialized()&&isBrowserSupported())try{_pushEvent(a,b)}catch(d){console.log("ZineOne: Error sending an event to Zineone cloud.")}},setCustomerId:function(a){if(!f&&
this.isInitialized()&&a&&""!=a&&isBrowserSupported())try{_onSetCustomerId(a)}catch(b){console.log("ZineOne: Error setting Customer ID.")}},setCustomKey:function(a,b){if(!f&&this.isInitialized()&&""!=a&&""!=b&&isBrowserSupported())try{_onSetCustomKey(a,b)}catch(d){console.log("ZineOne: Error setting custom key.")}},setDomain:function(a){if(!f&&isBrowserSupported())try{""!=a&&_setDomainName(a)}catch(b){console.log("ZineOne: Error setting custom domain.")}},turnOffApi:function(a){try{f=a}catch(b){console.log("ZineOne: Error on deactivating SDK.")}},
isInitialized:function(){try{if(f)return!1;e&&n&&(e?console.log("ZineOne: Initialized or Initialization is in flight."):e&&console.log("ZineOne: Not initialized."));return n}catch(a){console.log("ZineOne: Error identifying init status.")}},isDisabled:function(){return f}}}();var ZineOne=new Z1;(function(g){var m="";screen&&void 0!=screen.width&&(width=screen.width?screen.width:"",height=screen.height?screen.height:"",m+=""+width+"x"+height);var c=void 0!=navigator&&void 0!=navigator.userAgent?navigator.userAgent+
"":null,r=void 0!=c?c.substring(c.indexOf("/")+1):null,f=void 0!=navigator&&void 0!=navigator.appName?navigator.appName:null,n=void 0!=r?""+parseFloat(r):"Unknown";void 0!=r&&parseInt(r,10);var e;if(void 0==c)n=f="Unknown";else if(-1!=c.toLowerCase().indexOf("fb_iab")||-1!=c.toLowerCase().indexOf("fban")||-1!=c.toLowerCase().indexOf("[fb")){f="Facebook";var k=c.indexOf("FBAV/");n=-1==k?n:c.substring(k+5)}else if(-1!=c.toLowerCase().indexOf("messengerliteforios")||-1!=c.toLowerCase().indexOf("messengerforios"))f=
"Facebook",k=c.indexOf("FBAV/"),n=-1==k?n:c.substring(k+5);else if(-1!=c.toLowerCase().indexOf("instagram"))f="Instagram",k=c.toLowerCase().indexOf("instagram"),n=-1==k?n:c.substring(k+10);else if(-1!=c.toLowerCase().indexOf("facebookexternalhit")||-1!=c.toLowerCase().indexOf("facebookcatalog")){f="Facebook Crawler";k=c.toLowerCase().indexOf("facebookexternalhit");var q=20;-1==k&&(k=c.toLowerCase().indexOf("facebookcatalog"),q=16);n=-1==k?n:c.substring(k+q)}else-1!=(k=c.toLowerCase().indexOf("opera"))?
(f="Opera",n=c.substring(k+6),-1!=(k=c.indexOf("Version"))&&(n=c.substring(k+8))):-1!=(k=c.toLowerCase().indexOf("opr"))?(f="Opera",n=c.substring(k+4)):-1!=(k=c.toLowerCase().indexOf("msie"))?(f="Microsoft Internet Explorer",n=c.substring(k+5)):"Netscape"==f&&-1!=c.toLowerCase().indexOf("trident/")?(f="Microsoft Internet Explorer",n=c.substring(k+5),-1!=(k=c.indexOf("rv:"))&&(n=c.substring(k+3))):-1!=(k=c.toLowerCase().indexOf("edgios"))?(f="Edge",n=c.substring(k+7)):-1!=(k=c.toLowerCase().indexOf("edge"))||
-1!=(k=c.toLowerCase().indexOf("edga"))?(f="Edge",n=c.substring(k+5)):-1!=(k=c.toLowerCase().indexOf("edg"))?(f="Edge",n=c.substring(k+4)):-1!=c.toLowerCase().indexOf("samsung")?(f="Samsung Internet",k=c.toLowerCase().indexOf("samsungbrowser/"),q=15,-1==k&&(k=c.toLowerCase().indexOf("version/"),q=8),n=-1==k?n:c.substring(k+q)):-1!=(k=c.toLowerCase().indexOf("silk"))?(f="Amazon Silk",n=c.substring(k+5)):-1!=(k=c.toLowerCase().indexOf("firefox"))?(f="Firefox",n=c.substring(k+8)):-1!=(k=c.toLowerCase().indexOf("fxios"))?
(f="Firefox",n=c.substring(k+6)):-1!=(k=c.toLowerCase().indexOf("chrome"))?(f="Chrome",n=c.substring(k+7)):-1!=(k=c.toLowerCase().indexOf("safari"))?(f="Safari",n=c.substring(k+7),-1!=(k=c.indexOf("Version"))&&(n=c.substring(k+8)),-1!=(k=c.toLowerCase().indexOf("crios"))&&(f="Chrome",n=c.substring(k+6))):(q=c.lastIndexOf(" ")+1)<(k=c.lastIndexOf("/"))&&(f=c.substring(q,k),n=c.substring(k+1),f.toLowerCase()==f.toUpperCase()&&(f=navigator.appName));-1!=(e=n.indexOf(";"))&&(n=n.substring(0,e));-1!=(e=
n.indexOf(" "))&&(n=n.substring(0,e));-1!=(e=n.indexOf(")"))&&(n=n.substring(0,e));k=void 0!=n&&"Unknown"!=n?parseInt(""+n,10):"Unknown";isNaN(k)&&(n=void 0!=navigator&&void 0!=navigator.appVersion?""+parseFloat(navigator.appVersion):"Unknown",void 0!=navigator&&navigator.appVersion&&parseInt(navigator.appVersion,10));r=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(r);k=navigator.cookieEnabled?!0:!1;void 0==navigator||"undefined"!=typeof navigator.cookieEnabled||k||(document.cookie="testcookie",
k=-1!=document.cookie.indexOf("testcookie")?!0:!1);e="Unknown";q=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",
r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];
for(var w=0;w<q.length;w++){var y=q[w];if(y.r.test(c)){e=y.s;break}}q="Unknown";/Windows/.test(e)&&(q=/Windows (.*)/.exec(e)[1],e="Windows");switch(e){case "Mac OS X":w=/Mac OS X ([\._\d]+)/.exec(c);q=void 0!=w&&2<=w.length?w[1]:q;"Unknown"==q&&(w=/AppleWebKit\/([\._\d]+)/.exec(c),q=void 0!=w&&2<=w.length?w[1]:q);break;case "Android":w=/Android ([\._\d]+)/.exec(c);q=void 0!=w&&2<=w.length?w[1]:q;break;case "iOS":q=/(OS |os |OS_)(\d+((_|\.)\d+)?((_|\.)\d+)?)/.exec(c),q=void 0!=q&&3<=q.length?q[2]:
"Unknown",q=q.replace("/_/i",".")}w=g.location.pathname||"";var A=w.split("/");y=null;for(var G=A.length-1;0<=G&&!(y=A[G],0<y.length);G--);null==y&&(y="");A=/mobile|ip(hone|od|ad)|android|blackberry|iemobile|kindle|netfront|silk-accelerated|(hpw|web)os|fennec|minimo|opera m(obi|ini)|blazer|dolfin|dolphin|skyfire|zune/.test(c.toLowerCase());c=/ipad/.test(c.toLowerCase())||/macintosh/.test(c.toLowerCase())&&"ontouchend"in document||/android/.test(c.toLowerCase())&&/(chrome\/[.0-9]* (?!mobile))/.test(c.toLowerCase())||
-1<c.toLowerCase().indexOf("mozilla/5.0")&&-1<c.toLowerCase().indexOf("android ")&&-1<c.toLowerCase().indexOf("applewebkit")&&/(?!mobile)/.test(c.toLowerCase())&&!(-1<c.toLowerCase().indexOf("chrome"));Z1&&(Z1.window=g,Z1.window.browserInfo={screen:m,browser:f,browserVersion:n,mobile:r,os:e,osVersion:q,cookies:k,pageName:y,pagePath:w,deviceType:c?"tablet":A?"phone":"desktop"})})(this)};
